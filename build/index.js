!function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return s(i?i:t)},u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){function n(){this._events={}}e.exports=n,n.listenerCount=function(t,e){var i=t._events[e];return i?i.length:0},n.prototype.on=function(t,e){if("function"!=typeof e)throw new TypeError("Tried to register non-function as event handler for event: "+t);this.emit("newListener",t,e);var i=this._events,n=i[t];return void 0===n?i[t]=[e]:n.push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(t,e){return e.once?e.once+=1:e.once=1,this.on(t,e)},n.prototype.setMaxListeners=function(){console.warn("Method setMaxListeners not supported, there is no limit to the number of listeners")},n.prototype.removeListener=function(t,e){var i=this._events[t];if(void 0!==i){var n=i.indexOf(e);n!==-1&&(i.splice(n,1),0===i.length&&delete this._events[t],this.emit("removeListener",t,e))}return this},n.prototype.removeAllListeners=function(t){return t?delete this._events[t]:this._events={},this},n.prototype.hasListeners=function(t){return void 0!==this._events[t]},n.prototype.listeners=function(t){var e=this._events[t];return void 0!==e?e.slice():[]},n.prototype.emit=function(t){var e=this._events[t];if(void 0===e)return!1;e=e.slice();for(var i=!1,n=[],s=1;s<arguments.length;s++)n.push(arguments[s]);for(var s=0,r=e.length;s<r;s++){var o=e[s];o.apply(this,n),i=!0,o.once&&(o.once>1?o.once--:delete o.once,this.removeListener(t,o))}return i}},{}],2:[function(t,e,i){function n(t,e,i,n,s,r,o,a){this.x=~~t,this.y=~~e,this.tile=~~i,this.flipH=!!n,this.flipV=!!s,this.flipR=!!r,this.flagA=!!o,this.flagB=!!a}function s(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=new r(t*o,e*a),this._tilesheetPath="",t&&e&&this._init(t,e)}var r=t("../Texture"),o=settings.tileSize[0],a=settings.tileSize[1];n.prototype.draw=function(t){t.sprite(this.tile,this.x*o,this.y*a,this.flipH,this.flipV,this.flipR)},e.exports=s,s.prototype._isMap=!0;var h={},l=[];s.getMap=function(t){return"string"==typeof t?h[t]:"number"==typeof t?l[t]:(console.error("Map does not exist",t),null)},s._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.error("Map bank format incorrect"),{_type:"maps",maps:[]}):t:(console.error("No map bank"),{_type:"maps",maps:[]})},s.loadBank=function(t){t=s._checkBankFormat(t);for(var e=[],i=t.maps||[],n=0;n<i.length;n++)e.push((new s).load(i[n]))},Object.defineProperty(s.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&h[this._name]&&h[this._name]===this&&delete h[this._name],this._name=t,t&&!h[t]&&(h[t]=this)}}),s.prototype._init=function(t,e){this.texture.resize(t*o,e*a),this.width=t,this.height=e,this.items=[];for(var i=0;i<t;i++){this.items.push([]);for(var n=0;n<e;n++)this.items[i][n]=null}},s.prototype.resize=function(t,e){var i=this.items,n=Math.min(this.width,t),s=Math.min(this.height,e);this.texture.resize(t*o,e*a),this._init(t,e);for(var r=0;r<n;r++)for(var h=0;h<s;h++)this.items[r][h]=i[r][h];return this.redraw(),this},s.prototype.set=function(t,e,i,s,r,h,l,u){if(null===i||void 0===i)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var p=this.items[t][e]=new n(t,e,i,s,r,h,l,u);return this.texture.ctx.clearRect(t*o,e*a,o,a),p.draw(this.texture),this}},s.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture.ctx.clearRect(t*o,e*a,o,a),this},s.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},s.prototype.redraw=function(){this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]&&this.items[t][e].draw(this.texture);return this},s.prototype.draw=function(t,e){draw(this.texture,t,e)},s.prototype.setTilesheet=function(t){return this._tilesheetPath=t&&t.path||"",this.texture.setTilesheet(t),this.redraw(),this},s.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();t=t.split("/"),fileId=t.pop();for(var e=assets,i=0;i<t.length;i++)if(e=e[t[i]],!e)return console.warn("Could not find tilesheet",t);var n=e[fileId];n&&n instanceof Image&&this.setTilesheet(n)};var u,p;!function(){function t(t){var i=~~(t/s),n=t%s;return e[i]+e[n]}for(var e="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",i={},n=0;n<e.length;n++)i[e[n]]=n;var s=e.length,r=s*s-1,o=Math.pow(2,13),a=r-o-1;u=function(e){str="",count=0;for(var i=0;i<e.length;i++){var n=e[i];n===e[i+1]&&++count<a||(null===n&&(n=r),str+=t(n),count===a&&count--,0!==count&&(str+=t(o+count)),count=0)}return count===a&&count--,0!==count&&(str+=t(o+count)),str},p=function(t){arr=[];for(var e=0;e<t.length;){var n=t[e++],a=t[e++],h=i[n]*s+i[a];if(h===r)arr.push(null);else if(h>o)for(var l=h-o,u=arr[arr.length-1],p=0;p<l;p++)arr.push(u);else arr.push(h)}return arr}}(),s.prototype.save=function(){for(var t=this.width,e=this.height,i=new Array(t*e),n=0;n<t;n++)for(var s=0;s<e;s++){var r=this.items[n][s];i[n+s*t]=r?r.tile+(r.flipH<<8)+(r.flipV<<9)+(r.flipR<<10)+(r.flagA<<11)+(r.flagB<<12):null}var o={w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:u(i)};return o},s.prototype.load=function(t){var e=t.w,i=t.h;this._init(e,i),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var n=p(t.data),s=0;s<e;s++)for(var r=0;r<i;r++){var o=n[s+r*e];if(null!==o){var a=255&o,h=o>>8&1,l=o>>9&1,u=o>>10&1,c=o>>11&1,d=o>>12&1;this.set(s,r,a,h,l,u,c,d)}}return this.redraw(),this},s.prototype.copy=function(t,e,i,n){t=t||0,e=e||0,void 0!==i&&null!==i||(i=this.width),void 0!==n&&null!==n||(n=this.height);var r=new s(i,n);return r.paste(this,-t,-e),r},s.prototype.paste=function(t,e,i,n){e=e||0,i=i||0;for(var s=Math.min(t.width,this.width-e),r=Math.min(t.height,this.height-i),o=Math.max(0,-e),a=Math.max(0,-i),h=o;h<s;h++)for(var l=a;l<r;l++){var u=t.items[h][l];if(u)this.set(h+e,l+i,u.tile,u.flipH,u.flipV,u.flipR,u.flagA,u.flagB);else{if(n)continue;this.remove(h+e,l+i)}}return this.redraw(),this},s.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture.clear(),this},s.prototype.find=function(t,e,i){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===i&&(i=null);for(var n=[],s=0;s<this.width;s++)for(var r=0;r<this.height;r++){var o=this.items[s][r];if(o){var a=null===e||o.flagA===e,h=null===i||o.flagB===i;o.tile===t&&a&&h&&n.push(o)}}return n},s.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var i=0;i<this.height;i++)null===this.items[e][i]&&t.push({x:e,y:i});return t}},{"../Texture":3}],3:[function(t,e,i){function n(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i}function s(t,e){this.canvas=n(t,e),this.ctx=this.canvas.getContext("2d"),this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textOffset=1,this._textPadding=e-6*this._textLine-this._textOffset,this.camera={x:0,y:0},this.ctx.fillStyle=this.palette[0],this.ctx.strokeStyle=this.palette[1]}function r(t,e){for(var i=[219,438,511,14016,14043,14326,14335,28032,28123,28086,28159,32704,32731,32758,32767,128,146,384,402,9344,9362,9600,9618,192,210,448,466,9408,9426,9664,9682,32767,0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845],n=0;n<e.length;n++){t.fillStyle=e[n];for(var s=0;s<i.length;s++)for(var r=i[s],o=0;o<15;o++){var a=o%3,h=~~(o/3),l=r>>o&1;1===l&&t.fillRect(3*s+a,5*n+h,1,1)}}t.fillStyle=e[0]}var o=settings.tileSize[0],a=settings.tileSize[1],h=16,l=Math.PI/2;e.exports=s,s.prototype._isTexture=!0,s.prototype.palette=["#000000","#FFFFFF"],s.prototype.tilesheet=new s(o*h,a*h),s.prototype.textCharset=new s(384,5*s.prototype.palette.length),s.prototype.resize=function(t,e){return this.canvas.width=t,this.canvas.height=e,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textOffset=1,this._cursor.i=0,this._cursor.j=0,this.clear(),this},s.prototype.setPalette=function(t){s.prototype.palette=t,s.prototype.textCharset=new s(384,5*t.length),r(s.prototype.textCharset.ctx,t)},s.prototype.setGlobalTilesheet=function(t){s.prototype.tilesheet.clear().draw(t,0,0)},s.prototype.setTilesheet=function(t){return t?(this.tilesheet===s.prototype.tilesheet&&(this.tilesheet=new s(o*h,a*h)),this.tilesheet.clear().draw(t,0,0),this):void delete this.tilesheet},s.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this},s.prototype.sprite=function(t,e,i,n,s,r){var u=t%h,p=~~(t/h),c=this.ctx;return e=e||0,i=i||0,e=~~Math.round(e-this.camera.x),i=~~Math.round(i-this.camera.y),n||s||r?(c.save(),n&&(c.scale(-1,1),e*=-1,e-=o),s&&(c.scale(1,-1),i*=-1,i-=a),r?(c.translate(e+a,i),c.rotate(l)):c.translate(e,i),c.drawImage(this.tilesheet.canvas,u*o,p*a,o,a,0,0,o,a),c.restore(),this):(c.drawImage(this.tilesheet.canvas,u*o,p*a,o,a,e,i,o,a),this)},s.prototype.draw=function(t,e,i,n,s,r){t._isMap&&(t=t.texture.canvas),t._isTexture&&(t=t.canvas);var o=~~Math.round((e||0)-this.camera.x),a=~~Math.round((i||0)-this.camera.y);if(!n&&!s&&!r)return this.ctx.drawImage(t,o,a),this;var h=this.ctx;return h.save(),n&&(h.scale(-1,1),o*=-1,o-=t.width),s&&(h.scale(1,-1),a*=-1,a-=t.height),r?(h.translate(o+t.height,a),h.rotate(l)):h.translate(o,a),h.drawImage(t,0,0),h.restore(),this},s.prototype.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},s.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.locate(0,0),this},s.prototype.pen=function(t){return this._pen=t%this.palette.length,this.ctx.strokeStyle=this.palette[this._pen],this},s.prototype.paper=function(t){return this._paper=t%this.palette.length,this.ctx.fillStyle=this.palette[this._paper],this},s.prototype.rect=function(t,e,i,n){return this.ctx.strokeRect(~~(t-this.camera.x)+.5,~~(e-this.camera.y)+.5,~~(i-1),~~(n-1)),this},s.prototype.rectfill=function(t,e,i,n){return this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~i,~~n),this},s.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},s.prototype.print=function(t,e,i){if("object"==typeof t)try{t=JSON.stringify(t)}catch(e){t="[Object]"}else"string"!=typeof t&&(t=t.toString());if(void 0!==e){e=~~Math.round(e-this.camera.x),i=~~Math.round(i-this.camera.y);for(var n=0;n<t.length;n++)this.ctx.drawImage(this.textCharset.canvas,3*t.charCodeAt(n),5*this._pen,3,5,e,i,3,5),e+=4;return this}for(var n=0;n<t.length;n++){this._cursor.j>=this._textLine&&this.textScroll();var s=t.charCodeAt(n);10!==s&&13!==s?(this.ctx.drawImage(this.textCharset.canvas,3*s,5*this._pen,3,5,4*this._cursor.i,6*this._cursor.j+this._textOffset,3,5),this._cursor.i+=1,this._cursor.i>this._textColumn&&(this._cursor.i=0,this._cursor.j+=1)):(this._cursor.i=0,this._cursor.j+=1)}return this},s.prototype.println=function(t){return this.print(t),this.print("\n"),this},s.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=6,this.ctx.drawImage(this.canvas,0,-t),this.ctx.fillRect(0,this.canvas.height-t-this._textPadding,this.canvas.width,t+this._textPadding),this}},{}],4:[function(t,e,i){function n(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===~~i.readyState)return 200!==~~i.status?e("xhr:"+i.status):e&&e(null,JSON.parse(i.response))},i.open("GET",t,!0),i.send()}function s(t,e){var i=new XMLHttpRequest;i.open("POST","req",!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.onreadystatechange=function(){if(4===~~i.readyState){if(200!==~~i.status)return e&&e("xhr:"+i.status);var t=JSON.parse(i.response);return e&&e(t.error,t.result)}},i.send(JSON.stringify(t))}function r(t,e){var i=new Image;i.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},i.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},i.src=t}function o(t,e){function i(){e&&e(null,s),s.removeEventListener("canplaythrough",i),s.removeEventListener("error",n)}function n(){e&&e("snd:load"),s.removeEventListener("canplaythrough",i),s.removeEventListener("error",n)}var s=new Audio;s.preload=!0,s.loop=!1,s.addEventListener("canplaythrough",i),s.addEventListener("error",n),s.src=t,s.load()}function a(t,e){n("build/data.json",function(i,n){function s(t,e){var i=t.split("/"),n=i.pop(),s=n.split(".");s.pop(),s=s.join(".");for(var r=h,o=0,a=i.length;o<a;o++)r=r[i[o]];r[s]=e,i.push(s),e.name=s,e.path=i.join("/")}function a(){var i=c+d,f=i/u;e&&e(c,i,u,f);var y,v;i<l?(y=n.img[i],v=r):(y=n.snd[i-l],v=o),d+=1,v(p+y,function(e,i){e||s(y,i),c+=1,d-=1,c+d<u?a():0===d&&t(null,h)})}if(i)return t(i);var h=n.dat,l=n.img.length,u=l+n.snd.length,p=n.root,c=0,d=0;if(0===u)return t(null,h);for(var f=Math.min(5,u-1),y=0;y<=f;y++)a()})}i.loadJson=n,i.sendRequest=s,i.loadImage=r,i.loadSound=o,i.preloadStaticAssets=a},{}],5:[function(t,e,i){function n(){}function s(){for(var t=0;t<w;t++)m[_[t]]=!1,g[_[t]]=!1}function r(t,e){var i=y[t];i&&(e&&!v[i]&&(m[i]=!0),!e&&v[i]&&(g[i]=!0),v[i]=e)}function o(t,e,i){var n=new p(t,e),s=n.canvas;document.body.appendChild(s);var r=s.style;return r.width=t*i[0]+"px",r.height=e*i[1]+"px",n}function a(e,i){function n(){c.update(),o.update(),s(),T(n)}if(paper(0).pen(1).cls(),e)return print(e),console.error(e);window.assets=i,i.tilesheet&&tilesheet(i.tilesheet),f.loadBank(i.maps);var r=(new c.Ticker).useAsDefault();c.add(r);var o=t("../src/main.js");o.update&&(s(),n())}function h(t,e,i,n){rectfill(S-M,P-2,~~(n*M*2),4)}var l=t("../settings.json");window.settings=l;var u=t("assetLoader"),p=t("Texture"),c=t("tina"),d=t("EventEmitter"),f=t("Map");window.EventEmitter=d,window.TINA=c,window.inherits=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};window.audioManager={loadSound:n,stopLoopSound:n,playLoopSound:n,settings:{},addChannel:n};window.sfx=function(t,e,i,n){},window.music=function(t,e){};var y={},v=window.btn={},m=window.btnp={},g=window.btnr={},_=[],w=0;!function(){var t=l.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t){var i=t[e];y[i]=e,v[e]=!1,m[e]=!1,g[e]=!1,_.push(e)}w=_.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),r(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),r(t.keyCode,!1)}),window.texture=function(t){var e=new p(t.width,t.height);return e.ctx.drawImage(t,0,0),e},window.tilesheet=function(t){return p.prototype.setGlobalTilesheet(t)};var x=window.$screen=o(l.screen.width,l.screen.height,l.screen.pixelSize);x.setPalette(l.palette),window.cls=function(){return x.cls()},window.sprite=function(t,e,i,n,s,r){return x.sprite(t,e,i,n,s,r)},window.draw=function(t,e,i,n,s,r){return x.draw(t,e,i,n,s,r)},window.rect=function(t,e,i,n){return x.rect(t,e,i,n)},window.rectfill=function(t,e,i,n){return x.rectfill(t,e,i,n)},window.camera=function(t,e){return x.setCamera(t,e)},window.pen=function(t){return x.pen(t)},window.paper=function(t){return x.paper(t)},window.locate=function(t,e){return x.locate(t,e)},window.print=function(t,e,i){return x.print(t,e,i)},window.println=function(t){return x.println(t)},window.getMap=f.getMap,window.chr$=function(t){return String.fromCharCode(t)},window.clip=function(t,e,i){return Math.max(e,Math.min(i,t))},window.random=function(t){return~~Math.round(t*Math.random())};var b=1/60,T=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,b)},S=~~(l.screen.width/2),M=~~(l.screen.width/4),P=~~(l.screen.height/2);cls().paper(1).pen(1).rect(S-M-2,P-4,2*M+4,8),u.preloadStaticAssets(a,h)},{"../settings.json":29,"../src/main.js":49,EventEmitter:1,Map:2,Texture:3,assetLoader:4,tina:26}],6:[function(t,e,i){function n(t,e,i,n){this.start=t,this.end=t+e,this.duration=e,this.properties=n,this.to=i}function s(t,e){if(this._object=t,(null===e||void 0===e)&&t instanceof Array){e=[];for(var i=0;i<t.length;i+=1)e[i]=i}this._properties=e,this._from=null,this._interpolations=null,this._index=0,this._transitions=[],this._relative=!1,this._time=0,this._duration=0}var r=t("./Transition"),o=t("./TransitionRelative"),a=t("./easing"),h=t("./interpolation");n.prototype.update=function(t){for(var e=0;e<this.properties.length;e+=1){var i=this.properties[e];t[i]=this.to[i]}},e.exports=s,s.prototype.relative=function(t){return this._relative=t,this},s.prototype.reset=function(){return this._index=0,this._duration=0,this._transitions=[],this},s.prototype.interpolations=function(t){for(var e=0;e<this._properties.length;e+=1){var i=this._properties[e],n=t[i];void 0!==n?"string"==typeof n&&(void 0===h[n]?(console.warn("[AbstractTween.interpolations] Given interpolation does not exist"),t[i]=h.linear):t[i]=h[n]):t[i]=h.linear}return this._interpolations=t,this},s.prototype.from=function(t){return this._from=t,this._transitions.length>0&&(this._transitions[0].from=t),this},s.prototype._setFrom=function(){this._from={};for(var t=0;t<this._properties.length;t+=1){var e=this._properties[t];this._from[e]=this._relative===!0?0:this._object[e]}return this._from},s.prototype._getLastTransitionEnding=function(){return this._transitions.length>0?this._relative===!0?this._setFrom():this._transitions[this._transitions.length-1].to:null===this._from?this._setFrom():this._from},s.prototype.to=function(t,e,i,n,s){"string"==typeof i&&(void 0===a[i]?(console.warn("[AbstractTween.to] Given easing does not exist"),i=void 0):i=a[i]);var h=this._getLastTransitionEnding(),l=this._relative===!0?o:r,u=new l(this._properties,h,t,this._duration,e,i,n,this._interpolations,s);return this._transitions.push(u),this._duration+=e,this},s.prototype.wait=function(t){var e=this._getLastTransitionEnding();return this._transitions.push(new n(this._duration,t,e,this._properties)),this._duration+=t,this},s.prototype._update=function(){for(var t=this._transitions[this._index];t.end<=this._time;){if(this._index===this._transitions.length-1)return void t.update(this._object,1);this._relative===!0&&t.update(this._object,1),t=this._transitions[++this._index]}for(;this._time<=t.start;){if(0===this._index)return void t.update(this._object,0);this._relative===!0&&t.update(this._object,0),t=this._transitions[--this._index]}t.update(this._object,(this._time-t.start)/t.duration)},s.prototype._validate=function(){return 0!==this._transitions.length||(console.warn("[AbstractTween._validate] Cannot start a tween with no transition:",this),!1)}},{"./Transition":21,"./TransitionRelative":22,"./easing":25,"./interpolation":28}],7:[function(t,e,i){function n(){this._duration=0,this._onComplete=null,this._iterations=1,this._pingpong=!1,this._persist=!1}e.exports=n,n.prototype.setSpeed=function(t){0===t?0!==this._speed&&(this._startTime+=this._time/this._speed-this._time):0===this._speed?this._startTime+=this._time-this._time/t:this._startTime+=this._time/this._speed-this._time/t,this._speed=t,null!==this._player&&this._player._onPlayableChanged(this)},n.prototype.onComplete=function(t){return this._onComplete=t,this},n.prototype.getDuration=function(){return this._duration*this._iterations/this._speed},n.prototype._setDuration=function(t){this._duration=t,null!==this._player&&this._player._onPlayableChanged(this)},n.prototype._extendDuration=function(t){this._duration+=t,null!==this._player&&this._player._onPlayableChanged(this)},n.prototype._getEndTime=function(){return this._speed>0?this._startTime+this.getDuration():this._speed<0?this._startTime:1/0},n.prototype._setStartTime=function(t){this._speed>0?this._startTime=t:this._speed<0?this._startTime=t-this.getDuration():this._startTime=1/0},n.prototype._getStartTime=function(){return this._speed>0?this._startTime:this._speed<0?this._startTime+this.getDuration():-(1/0)},n.prototype._isTimeWithin=function(t){return this._speed>0?this._startTime<t&&t<this._startTime+this.getDuration():!(this._speed<0)||this._startTime+this.getDuration()<t&&t<this._startTime},n.prototype._overlaps=function(t,e){return this._speed>0?(this._startTime-e)*(this._startTime+this.getDuration()-t)<=0:!(this._speed<0)||(this._startTime+this.getDuration()-e)*(this._startTime-t)<=0},n.prototype.goToEnd=function(){return this.goTo(this.getDuration(),this._iterations-1)},n.prototype.loop=function(){return this.iterations(1/0)},n.prototype.iterations=function(t){return t<0?(console.warn("[BriefExtension.iterations] Number of iterations cannot be negative"),this):(this._iterations=t,null!==this._player&&this._player._onPlayableChanged(this),this)},n.prototype.persist=function(t){return this._persist=t,this},n.prototype.pingpong=function(t){return this._pingpong=t,null!==this._player&&this._player._onPlayableChanged(this),this},n.prototype._complete=function(t){return this._persist===!0?(this._startTime+=t,void this._player._onPlayableChanged(this)):this._player._inactivate(this)===!1?this:void(null!==this._onComplete&&this._onComplete(t))};var s=1e-6;n.prototype._moveTo=function(t,e,i){e*=this._speed;var n;if(0!==e)if(1===this._iterations)this._time=(t-this._startTime)*this._speed,e>0?this._time>=this._duration?(n=this._time-this._duration,this._time=this._duration):this._time<0:e<0&&this._time<=0&&(n=this._time,this._time=0);else{t=(t-this._startTime)*this._speed;var r=t/this._duration;e>0?0<r&&r<this._iterations?this._time=t%this._duration:(n=(r-this._iterations)*this._duration,this._time=this._duration*(1-(Math.ceil(this._iterations)-this._iterations))):e<0&&(0<r&&r<this._iterations?this._time=t%this._duration:(n=r*this._duration,this._time=0)),this._pingpong===!0&&(void 0===n?0===(1&Math.ceil(r))&&(this._time=this._duration-this._time):Math.ceil(this._iterations)===this._iterations&&0===(1&Math.ceil(this._iterations))&&(this._time=this._duration-this._time))}void 0!==i&&void 0===n&&(e>0&&this.duration-this._time<s?(n=i,this._time=this._duration):e<0&&this._time<s&&(n=i,this._time=0)),this._update(e,n),null!==this._onUpdate&&(void 0===n?this._onUpdate(this._time,e):this._onUpdate(this._time,e-n)),void 0!==n&&this._complete(n)}},{}],8:[function(t,e,i){function n(){r.call(this),o.call(this)}var s=t("./inherit"),r=t("./Playable"),o=t("./BriefExtension");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,s(n,o),e.exports=n},{"./BriefExtension":7,"./Playable":13,"./inherit":27}],9:[function(t,e,i){function n(){r.call(this),o.call(this)}var s=t("./inherit"),r=t("./Player"),o=t("./BriefExtension");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,s(n,o),e.exports=n,n.prototype._onAllPlayablesRemoved=function(){this._duration=0},n.prototype._updateDuration=function(){var t,e,i,n=0;for(t=this._activePlayables.first;null!==t;t=t.next)e=t.object,i=e._getStartTime()+e.getDuration(),i>n&&(n=i);for(t=this._inactivePlayables.first;null!==t;t=t.next)e=t.object,i=e._getStartTime()+e.getDuration(),i>n&&(n=i);this._setDuration(n)},n.prototype._onPlayableChanged=n.prototype._updateDuration,n.prototype._onPlayableRemoved=n.prototype._updateDuration},{"./BriefExtension":7,"./Player":14,"./inherit":27}],10:[function(t,e,i){function n(t){return this instanceof n==!1?new n(t):(s.call(this),void(this._duration=t))}var s=t("./BriefPlayable");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},{"./BriefPlayable":8}],11:[function(t,e,i){function n(t,e,i,n){this.object=t,this.previous=e,this.next=i,this.container=n}function s(){this.first=null,this.last=null,this.length=0}e.exports=s,s.prototype.addFront=function(t){var e=new n(t,null,this.first,this);return null===this.first?(this.first=e,this.last=e):(this.first.previous=e,this.first=e),this.length+=1,e},s.prototype.add=s.prototype.addFront,s.prototype.addBack=function(t){var e=new n(t,this.last,null,this);return null===this.first?(this.first=e,this.last=e):(this.last.next=e,this.last=e),this.length+=1,e},s.prototype.popFront=function(t){var e=this.first.object;return this.removeByReference(this.first),e},s.prototype.pop=s.prototype.popFront,s.prototype.popBack=function(t){var e=this.last.object;return this.removeByReference(this.last),e},s.prototype.addBefore=function(t,e){var i=new n(e,t.previous,t,this);return null!==t.previous&&(t.previous.next=i),t.previous=i,this.first===t&&(this.first=i),this.length+=1,i},s.prototype.addAfter=function(t,e){var i=new n(e,t,t.next,this);return null!==t.next&&(t.next.previous=i),t.next=i,this.last===t&&(this.last=i),this.length+=1,i},s.prototype.moveToTheBeginning=function(t){return!(!t||t.container!==this)&&(null===t.previous||(t.previous.next=t.next,this.last===t?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=this.first,t.next.previous=t,this.first=t,!0))},s.prototype.moveToTheEnd=function(t){return!(!t||t.container!==this)&&(null===t.next||(t.next.previous=t.previous,this.first===t?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=this.last,t.previous.next=t,this.last=t,!0))},s.prototype.removeByReference=function(t){return t.container!==this?(console.warn("[DoublyList.removeByReference] Trying to remove a node that does not belong to the list"),t):(null===t.next?this.last=t.previous:t.next.previous=t.previous,null===t.previous?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=null,t.container=null,this.length-=1,null)},s.prototype.remove=function(t){for(var e=this.first;null!==e;e=e.next)if(e.object===t)return this.removeByReference(e),!0;return!1},s.prototype.getNode=function(t){for(var e=this.first;null!==e;e=e.next)if(e.object===t)return e;return null},s.prototype.clear=function(){for(var t=this.first;null!==t;t=t.next)t.container=null;this.first=null,this.last=null,this.length=0},s.prototype.forEach=function(t,e){for(var i=this.first;i;i=i.next)t(i.object,e)},s.prototype.toArray=function(){for(var t=[],e=this.first;null!==e;e=e.next)t.push(e.object);return t}},{}],12:[function(t,e,i){function n(t,e){if(this instanceof n==!1)return new n(t,e);s.call(this),this._tweensPerObject={},this._tweens=[],this._propertyChains={},this._propertyChainStrings=[];for(var i,o,a={},h={},l=0;l<e.length;l+=1){var u=e[l];if(o=u.substring(0,u.lastIndexOf(".")),void 0===h[o]){for(var p=u.split("."),c=p.length-1,d=t,f=0;f<c;f+=1)d=d[p[f]];i=p[c],d[i]instanceof Array?(h[u]=null,a[u]=d[i],this._propertyChainStrings.push(u),this._propertyChains[u]=p):(h[o]=[i],a[o]=d,this._propertyChainStrings.push(o),p.pop(),this._propertyChains[o]=p)}else i=u.substring(u.lastIndexOf(".")+1),h[o].push(i)}for(o in a){var y=a[o],v=h[o],m=new r(y,v);this._tweens.push(m),this._tweensPerObject[o]=m}}var s=t("./BriefPlayable"),r=t("./AbstractTween");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.relative=function(t){for(var e=0;e<this._tweens.length;e+=1)this._tweens[e].relative(t);return this},n.prototype.reset=function(){for(var t=0;t<this._tweens.length;t+=1)this._tweens[t].reset();return this._duration=0,this},n.prototype.interpolations=function(t){for(var e=0;e<this._propertyChainStrings.length;e+=1){for(var i=this._propertyChainStrings[e],n=this._propertyChains[i],s=n.length,r=t,o=0;o<s&&void 0!==r;o+=1)r=r[n[o]];void 0!==r&&this._tweensPerObject[i].interpolations(r)}return this},n.prototype.from=function(t){for(var e=0;e<this._propertyChainStrings.length;e+=1){for(var i=this._propertyChainStrings[e],n=this._propertyChains[i],s=n.length,r=t,o=0;o<s&&void 0!==r;o+=1)r=r[n[o]];void 0!==r&&this._tweensPerObject[i].from(r)}return this},n.prototype.to=function(t,e,i,n,s){for(var r=0;r<this._propertyChainStrings.length;r+=1){for(var o=this._propertyChainStrings[r],a=this._propertyChains[o],h=a.length,l=t,u=0;u<h;u+=1)l=l[a[u]];var p=s;for(u=0;u<h&&void 0!==p;u+=1)p=p[a[u]];this._tweensPerObject[o].to(l,e,i,n,p)}return this._extendDuration(e),this},n.prototype.wait=function(t){for(var e=0;e<this._tweens.length;e+=1)this._tweens[e].wait(t);return this._extendDuration(t),this},n.prototype._update=function(){for(var t=0;t<this._tweens.length;t+=1){var e=this._tweens[t];e._time=this._time,e._update()}}},{"./AbstractTween":6,"./BriefPlayable":8}],13:[function(t,e,i){function n(){this._player=null,this._handle=null,this._startTime=0,this._time=0,this._speed=1,this._onStart=null,this._onPause=null,this._onResume=null,this._onUpdate=null,this._onStop=null}e.exports=n,Object.defineProperty(n.prototype,"speed",{get:function(){return this._speed},set:function(t){this.setSpeed(t)}}),Object.defineProperty(n.prototype,"time",{get:function(){return this._time},set:function(t){this.goTo(t)}}),n.prototype.onStart=function(t){return this._onStart=t,this},n.prototype.onUpdate=function(t){return this._onUpdate=t,this},n.prototype.onStop=function(t){return this._onStop=t,this},n.prototype.onPause=function(t){return this._onPause=t,this},n.prototype.onResume=function(t){return this._onResume=t,this},n.prototype.tweener=function(t){return null===t||void 0===t?(console.warn("[Playable.tweener] Given tweener is invalid:",t),this):(this._player=t,this)},n.prototype.setSpeed=function(t){return t<0?void console.warn("[Playable.speed] This playable cannot have negative speed"):(0===t?0!==this._speed&&(this._startTime+=this._time/this._speed-this._time):0===this._speed?this._startTime+=this._time-this._time/t:this._startTime+=this._time/this._speed-this._time/t,this._speed=t,void(null!==this._player&&this._player._onPlayableChanged(this)))},n.prototype.goTo=function(t,e){return 1===this._iterations?0===this._speed?this._startTime+=this._time-t:this._startTime+=(this._time-t)/this._speed:(e=e||0,0===this._speed?this._startTime+=this._time-t-e*this._duration:this._startTime+=(this._time-t-e*this._duration)/this._speed),this._time=t,null!==this._player&&this._player._onPlayableChanged(this),this},n.prototype.goToBeginning=function(){return this.goTo(0,0)},n.prototype.getDuration=function(){return 1/0},n.prototype._getEndTime=function(){return 1/0},n.prototype._setStartTime=function(t){this._startTime=t},n.prototype._getStartTime=function(){return this._startTime},n.prototype._isWithin=function(t){return this._startTime<t},n.prototype._overlaps=function(t,e){return(t-this._startTime)*(e-this._startTime)<=0},n.prototype.rewind=function(){return this.goTo(0,0),this},n.prototype.delay=function(t){return this.start(-t)},n.prototype.start=function(t){return null===this._player&&(this._player=TINA._startDefaultTweener()),this._validate()===!1?this:this._player._add(this)===!1?this:(void 0!==t&&null!==t||(t=0),this._startTime=this._player._time-t,this)},n.prototype._start=function(){null!==this._onStart&&this._onStart()},n.prototype.stop=function(){return null===this._player?void console.warn("[Playable.stop] Trying to stop a playable that was never started."):this._player._remove(this)===!1?this:(null!==this._onStop&&this._onStop(),this)},n.prototype.resume=function(){return this._player._activate(this)===!1?this:(null!==this._onResume&&this._onResume(),this)},n.prototype.pause=function(){return this._player._remove(this)===!1?this:(null!==this._onPause&&this._onPause(),this)},n.prototype._moveTo=function(t,e){e*=this._speed,this._time=(t-this._startTime)*this._speed,
this._update(e),null!==this._onUpdate&&this._onUpdate(this._time,e)},n.prototype._update=function(){},n.prototype._validate=function(){}},{}],14:[function(t,e,i){function n(){s.call(this),this._activePlayables=new r,this._inactivePlayables=new r,this._playablesToRemove=new r,this._silent=!0,this._debug=!1}var s=t("./Playable"),r=t("./DoublyList");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._add=function(t){return null===t._handle?(t._handle=this._inactivePlayables.add(t),t._player=this,!0):t._handle.container===this._playablesToRemove?(t._handle=this._playablesToRemove.removeByReference(t._handle),!0):t._handle.container===this._activePlayables?(this._warn("[Player._add] Playable is already present, and active"),!1):t._handle.container===this._inactivePlayables?(this._warn("[Player._add] Playable is already present, but inactive (could be starting)"),!1):(this._warn("[Player._add] Playable is used elsewhere"),!1)},n.prototype._remove=function(t){return null===t._handle?(this._warn("[Player._remove] Playable is not being used"),!1):t._handle.container===this._activePlayables?(t._handle=this._playablesToRemove.add(t._handle),!0):t._handle.container===this._inactivePlayables?(t._handle=this._inactivePlayables.removeByReference(t._handle),!0):t._handle.container===this._playablesToRemove?(this._warn("[Player._remove] Playable is already being removed"),!1):(this._warn("[Player._add] Playable is used elsewhere"),!1)},n.prototype.remove=function(t){return t._handle.container===this._activePlayables&&t.stop(),this._remove(t),this._onPlayableRemoved(t),this},n.prototype.removeAll=function(){for(var t=this._activePlayables.first;null!==t;){var e=t.next;t.object.stop(),t=e}return this._handlePlayablesToRemove(),this},n.prototype.possess=function(t){return null!==t._handle&&(t._handle.container===this._activePlayables||t._handle.container===this._inactivePlayables)},n.prototype._handlePlayablesToRemove=function(){for(;this._playablesToRemove.length>0;){var t=this._playablesToRemove.pop(),e=t.object;e._handle=this._activePlayables.removeByReference(t)}0===this._activePlayables.length&&0===this._inactivePlayables.length&&this._onAllPlayablesRemoved()},n.prototype.clear=function(){return this._activePlayables.clear(),this._inactivePlayables.clear(),this._playablesToRemove.clear(),this._controls.clear(),this},n.prototype._warn=function(t){this._silent===!1&&console.warn(t),this._debug===!0},n.prototype.silent=function(t){return this._silent=t||!1,this},n.prototype.debug=function(t){return this._debug=t||!1,this},n.prototype.stop=function(){for(var t=this._activePlayables.first;null!==t;){var e=t.next,i=t.object;i.stop(),t=e}this._handlePlayablesToRemove(),s.prototype.stop.call(this)},n.prototype._activate=function(t){this._inactivePlayables.removeByReference(t._handle),t._handle=this._activePlayables.addBack(t)},n.prototype._inactivate=function(t){return null===t._handle?void this._warn("[Playable.stop] Cannot stop a playable that is not running"):(this._activePlayables.removeByReference(t._handle),void(t._handle=this._inactivePlayables.addBack(t)))},n.prototype._updatePlayableList=function(t){this._handlePlayablesToRemove();var e,i;t>0?(e=this._time-t,i=this._time):(e=this._time,i=this._time-t);for(var n=this._inactivePlayables.first;null!==n;){var s=n.object;n=n.next,s._overlaps(e,i)&&(this._activate(s),s._start())}},n.prototype._update=function(t,e){this._updatePlayableList(t);for(var i=this._activePlayables.first;null!==i;i=i.next)void 0===e?i.object._moveTo(this._time,t):i.object._moveTo(this._time,t,e)},n.prototype._onPlayableChanged=function(){},n.prototype._onPlayableRemoved=function(){},n.prototype._onAllPlayablesRemoved=function(){}},{"./DoublyList":11,"./Playable":13}],15:[function(e,i,n){function s(t,e){this.time=t,this.values=e}function r(t,e,i,n){this.object=t,this.properties=e,this.records=new h,this.currentRecord=null,this.isIn=!1,this.onIn=i||null,this.onOut=n||null}function o(t){return this instanceof o==!1?new o:(a.call(this),this._duration=1/0,this._slackTime=0,this._maxRecordingDuration=t||1/0,this._recordedObjects=[],this._recordingObjects={},this._recordingObjectLabels=[],this._recording=!0,this._playing=!1,this._smooth=!1,this._onStartRecording=null,this._onStopRecording=null,this._onStartPlaying=null,void(this._onStopPlaying=null))}var a=e("./BriefPlayable"),h=e("./DoublyList");r.prototype.erase=function(t,e){if(e<t){var i=t;t=e,e=i}var n=this.records.last;if(n.object.time<=e){for(;null!==n&&n.object.time>=t;){var s=n.previous;this.records.removeBeReference(n),n=s}return void(null===this.currentRecord.container&&(this.currentRecord=n))}for(var r=this.records.first;null!==r&&r.object.time<=e;){var o=r.next;r.object.time>=t&&this.records.removeBeReference(r),r=o}null===this.currentRecord.container&&(this.currentRecord=r)},r.prototype.record=function(t,e){if(0!==e||null===this.currentRecord||this.currentRecord.time!==t){for(var i=[],n=0;n<this.properties.length;n+=1)i.push(this.object[this.properties[n]]);var r=new s(t,i);return 0===this.records.length?void(this.currentRecord=this.records.add(r)):void(this.currentRecord.object.time<t?this.currentRecord=this.records.addAfter(this.currentRecord,r):this.currentRecord=this.records.addBefore(this.currentRecord,r))}},r.prototype.goTo=function(t){for(;this.currentRecord.object.time<t;)this.currentRecord=this.currentRecord.next;for(;t<this.currentRecord.object.time;)this.currentRecord=this.currentRecord.previous},r.prototype.play=function(e,i,n){var s,r=this.properties.length,o=this.records.first,a=this.records.last;if(s=0===i?this.isIn:this.isIn===!0?o.object.time<e&&e<a.object.time:o.object.time<=e&&e<=a.object.time,s!==this.isIn)this.isIn=!this.isIn,s===!0&&null!==this.onIn&&this.onIn();else if(this.isIn===!1)return;for(var h=null===this.currentRecord.previous?this.currentRecord:this.currentRecord.previous;this.currentRecord.object.time<=e;){h=this.currentRecord;var l=this.currentRecord.next;if(null===l)break;this.currentRecord=l}for(;e<=h.object.time;){this.currentRecord=h;var u=h.previous;if(null===u)break;h=u}var p;if(n){var c=h.object.time,d=this.currentRecord.object.time,f=h.object.values,y=this.currentRecord.object.values,v=d-c,m=(t-c)/v,g=(d-t)/v;for(p=0;p<r;p+=1)this.object[this.properties[p]]=f[p]*m+y[p]*g}else{var _=this.currentRecord.object.values;for(p=0;p<r;p+=1)this.object[this.properties[p]]=_[p]}s===!1&&null!==this.onOut&&this.onOut()},o.prototype=Object.create(a.prototype),o.prototype.constructor=o,i.exports=o,o.prototype.getDuration=function(){var t;return t=this._playing===!0?this._time>this._maxRecordingDuration?this._maxRecordingDuration:this._time:1/0,t*this._iterations/this._speed},o.prototype.smooth=function(t){return this._smooth=t,this},o.prototype.onStartRecording=function(t){return this._onStartRecording=t,this},o.prototype.onStopRecording=function(t){return this._onStopRecording=t,this},o.prototype.onStartPlaying=function(t){return this._onStartPlaying=t,this},o.prototype.onStopPlaying=function(t){return this._onStopPlaying=t,this},o.prototype.reset=function(){return this._recordedObjects=[],this._recordingObjects={},this._recordingObjectLabels=[],this},o.prototype.record=function(t,e,i,n,s){var o=new r(e,i,n,s);return this._recordingObjects[t]=o,this._recordedObjects.push(o),this._recordingObjectLabels.push(t),this},o.prototype.stopRecordingObject=function(t){delete this._recordingObjects[t];var e=this._recordingObjectLabels.indexOf(t);return e===-1?(console.warn("[Recorder.stopRecordingObject] Trying to stop recording an object that is not being recording:",t),this):(this._recordingObjectLabels.splice(e,1),this)},o.prototype.removeRecordedObject=function(t){var e=this._recordingObjects[t];delete this._recordingObjects[t];var i=this._recordingObjectLabels.indexOf(t);i!==-1&&this._recordingObjectLabels.splice(i,1);var n=this._recordedObjects.indexOf(e);return n===-1?(console.warn("[Recorder.removeRecordedObject] Trying to remove an object that was not recorded:",t),this):(this._recordingObjectLabels.splice(n,1),this)},o.prototype.recording=function(t){return this._recording!==t&&(this._recording=t,this._recording===!0?(this._playing===!0&&(null!==this._onStopPlaying&&this._onStopPlaying(),this._playing=!1),this._duration=1/0,null!==this._player&&this._player._onPlayableChanged(this),null!==this._onStartRecording&&this._onStartRecording()):null!==this._onStopRecording&&this._onStopRecording()),this},o.prototype.playing=function(t){return this._playing!==t&&(this._playing=t,this._playing===!0?(this._recording===!0&&(null!==this._onStopRecording&&this._onStopRecording(),this._recording=!1),this._duration=this._time,this.goToBeginning(this._startTime+this.getDuration()),null!==this._onStartPlaying&&this._onStartPlaying()):null!==this._onStopPlaying&&this._onStopPlaying()),this},o.prototype._update=function(t){var e,i=this._slackTime+this._time;if(this._recording===!0){var n,s;t>0?(n=this._time-this._maxRecordingDuration,s=n>0):(n=this._time,s=n<0);var r=this._recordingObjectLabels.length;for(e=0;e<r;e+=1){var o=this._recordingObjectLabels[e],a=this._recordingObjects[o];a.record(i,t),s===!0&&a.erase(0,n)}n>0&&(this._slackTime+=n,this._setStartTime(this._startTime+n),this._player._onPlayableChanged(this))}else if(this._playing===!0){var h=this._recordedObjects.length;for(e=0;e<h;e+=1)this._recordedObjects[e].play(i,t,this._smooth)}}},{"./BriefPlayable":8,"./DoublyList":11}],16:[function(t,e,i){function n(){return this instanceof n==!1?new n:(this._sequencedPlayables=new o,void s.call(this))}var s=t("./Timeline"),r=t("./Delay"),o=t("./DoublyList");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.add=function(t){return this._sequencedPlayables.addBack(t),s.prototype.add.call(this,t,this._duration)},n.prototype.addDelay=function(t){return this.add(new r(t))},n.prototype._reconstruct=function(){var t,e,i=this._activePlayables.first;null!==i&&(t=i.object,e=this._time-t._getStartTime());for(var n=0,s=this._sequencedPlayables.first;null!==s;s=s.next){var r=s.object;r._setStartTime(n),n=r._getEndTime()}if(null!==i){var o=(this._getStartTime(),this._time-t._getStartTime()),a=e-o;this._startTime+=a}this._duration=n,null!==this._player&&this._player._onPlayableChanged(this)},n.prototype.substitute=function(t,e){if(0===this._sequencedPlayables.length)return void this._warn("[Sequence.substitute] The sequence is empty!");var i=this._sequencedPlayables.getNode(t);this._sequencedPlayables.addAfter(i,e),this._add(e),this.remove(t)},n.prototype._onPlayableRemoved=function(t){this._sequencedPlayables.remove(t),0!==this._sequencedPlayables.length&&this._reconstruct()},n.prototype._onPlayableChanged=n.prototype._reconstruct},{"./Delay":10,"./DoublyList":11,"./Timeline":19}],17:[function(t,e,i){(function(i){var n,s=t("./DoublyList");"undefined"!=typeof window?n=window:"undefined"!=typeof i?n=i:(console.warn("[TINA] Your environment might not support TINA."),n=this);var r=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(t,1e3/60)}}(),o=n.performance||Date,a={_activeTweeners:new s,_inactiveTweeners:new s,_tweenersToRemove:new s,_defaultTweener:null,_startTime:0,_time:0,_running:!1,_onStart:null,_onPause:null,_onResume:null,_onUpdate:null,_onStop:null,_pauseOnLostFocus:!1,_pauseOnLostFocusInitialised:!1,onStart:function(t){return this._onStart=t,this},onUpdate:function(t){return this._onUpdate=t,this},onStop:function(t){return this._onStop=t,this},onPause:function(t){return this._onPause=t,this},isRunning:function(){return this._running===!0},update:function(){var t=o.now()-this._startTime,e=t-this._time;for(e<0?(e=1,this._startTime-=1,this._time+=1):this._time=t;this._tweenersToRemove.length>0;){var i=this._tweenersToRemove.pop();i._handle=this._activeTweeners.removeByReference(i._handle)}for(;this._inactiveTweeners.length>0;){var n=this._inactiveTweeners.pop();n._handle=this._activeTweeners.addBack(n),n._start()}for(var s=this._activeTweeners.first;null!==s;s=s.next)s.object._moveTo(this._time,e);null!==this._onUpdate&&this._onUpdate(this._time,e)},reset:function(){var t=o.now(),e=t-this._time;this._startTime+=e,this._time=0},start:function(){if(this._startAutomaticUpdate()!==!1){for(null!==this._onStart&&this._onStart();this._inactiveTweeners.length>0;){var t=this._inactiveTweeners.first;this._activate(t.object)}return this}},stop:function(){if(this._stopAutomaticUpdate()!==!1){for(;this._activePlayables.length>0;){var t=this._activePlayables.first;t.object.stop()}return null!==this._onStop&&this._onStop(),this}},_startAutomaticUpdate:function(){function t(){a._running===!0&&(a.update(),r(t))}return this._running===!0?(console.warn("[TINA.start] TINA is already running"),!1):(this.reset(),this._running=!0,r(t),!0)},_stopAutomaticUpdate:function(){return this._running===!1?(console.warn("[TINA.pause] TINA is not running"),!1):(this._running=!1,!0)},pause:function(){if(this._stopAutomaticUpdate()!==!1){for(var t=this._activeTweeners.first;null!==t;t=t.next)t.object._pause();return null!==this._onPause&&this._onPause(),this}},resume:function(){if(this._startAutomaticUpdate()!==!1){null!==this._onResume&&this._onResume();for(var t=this._activeTweeners.first;null!==t;t=t.next)t.object._resume();return this}},_initialisePauseOnLostFocus:function(){if(this._pauseOnLostFocusInitialised!==!0){if(void 0===document)return void console.warn("[TINA.pauseOnLostFocus] Cannot pause on lost focus because TINA is not running in a webpage (node.js does not allow this functionality)");var t,e;if("undefined"!=typeof document.hidden?(t="hidden",e="visibilitychange"):"undefined"!=typeof document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(t="msHidden",e="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),"undefined"==typeof document[t])return void console.warn("[Tweener] Cannot pause on lost focus because the browser does not support the Page Visibility API");this._pauseOnLostFocusInitialised=!0;var i=!1;document.addEventListener(e,function(){document[t]&&(i=a.isRunning(),i&&a._pauseOnLostFocus&&a.pause()),document[t]||i&&a._pauseOnLostFocus&&a.resume()},!1)}},pauseOnLostFocus:function(t){return t===!0&&this._pauseOnLostFocusInitialised===!1&&this._initialisePauseOnLostFocus(),this._pauseOnLostFocus=t,this},_add:function(t){return this._running===!1&&this.start(),null===t._handle?(t._handle=this._inactiveTweeners.add(t),void(t._player=this)):t._handle.container===this._tweenersToRemove?void(t._handle=this._tweenersToRemove.removeByReference(t._handle)):void 0},add:function(t){return this._add(t),this},_inactivate:function(t){null!==t._handle&&this._activePlayables.removeByReference(t._handle),t._handle=this._inactivePlayables.addBack(t)},_remove:function(t){if(null!==t._handle)return t._handle.container===this._activeTweeners?void(t._handle=this._tweenersToRemove.add(t._handle)):t._handle.container===this._inactiveTweeners?void(t._handle=this._inactiveTweeners.removeByReference(t._handle)):void 0},remove:function(t){return this._remove(t),this},setDefaultTweener:function(t){return this._defaultTweener=t,this},getDefaultTweener:function(){if(null===this._defaultTweener){var t=this.Timer;this._defaultTweener=new t}return this._defaultTweener},_startDefaultTweener:function(){var t=this.getDefaultTweener();return this._add(t),t}};e.exports=n.TINA=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./DoublyList":11}],18:[function(t,e,i){function n(t){return this instanceof n==!1?new n(t):(s.call(this),void(this.tupt=t||1))}var s=t("./Tweener");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._moveTo=function(t,e){this._time+=this.tupt,e=this.tupt,this._update(e),null!==this._onUpdate&&this._onUpdate(this._time,e)},n.prototype.convertToTicks=function(t){return t/this.tupt},n.prototype.convertToTimeUnits=function(t){return t*this.tupt}},{"./Tweener":24}],19:[function(t,e,i){function n(){return this instanceof n==!1?new n:void s.call(this)}var s=t("./BriefPlayer");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.add=function(t,e){null!==e&&void 0!==e||(e=0),t._setStartTime(e),this._add(t);var i=t._getEndTime();return i>this._duration&&this._setDuration(i),this}},{"./BriefPlayer":9}],20:[function(t,e,i){function n(t){return this instanceof n==!1?new n(t):(s.call(this),void(this._speed=t/1e3||1))}var s=t("./Tweener");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperty(n.prototype,"tups",{get:function(){return 1e3*this._speed},set:function(t){this.speed=t/1e3}}),n.prototype.convertToSeconds=function(t){return t/(1e3*this._speed)},n.prototype.convertToTimeUnits=function(t){return t*this._speed*1e3}},{"./Tweener":24}],21:[function(t,e,i){function n(t,e){var i=this.prop;t[i]=this.from[i]*(1-e)+this.to[i]*e}function s(t,e){for(var i=this.props,n=0;n<this.props.length;n+=1){var s=i[n];t[s]=this.from[s]*(1-e)+this.to[s]*e}}function r(t,e){var i=this.prop;t[i]=this.interps[i](e,this.from[i],this.to[i],this.interpParams[i])}function o(t,e){for(var i=this.props,n=0;n<i.length;n+=1){var s=i[n];t[s]=this.interps[s](e,this.from[s],this.to[s],this.interpParams[s])}}function a(t,e){e=this.easing(e,this.easingParam);var i=this.prop;t[i]=this.from[i]*(1-e)+this.to[i]*e}function h(t,e){var i=this.props;e=this.easing(e,this.easingParam);for(var n=0;n<i.length;n+=1){var s=i[n];t[s]=this.from[s]*(1-e)+this.to[s]*e}}function l(t,e){var i=this.prop;t[i]=this.interps[i](this.easing(e,this.easingParam),this.from[i],this.to[i],this.interpParams[i])}function u(t,e){var i=this.props;e=this.easing(e,this.easingParam);for(var n=0;n<i.length;n+=1){var s=i[n];t[s]=this.interps[s](e,this.from[s],this.to[s],this.interpParams[s])}}function p(t,e,i,n,s,r,o,a,h){this.start=n,this.end=n+s,this.duration=s,this.from=e,this.to=i;var l;r?(l=1,this.easing=r,this.easingParam=o):l=0;var u;null===a?u=0:(u=1,this.interps=a,this.interpParams=h||{});var p;1===t.length?(p=0,this.prop=t[0],this.props=null):(p=1,this.prop=null,this.props=t),this.update=c[l][u][p]}var c=[[[n,s],[r,o]],[[a,h],[l,u]]];e.exports=p},{}],22:[function(t,e,i){function n(t,e){var i=this.prop,n=this.from[i]*(1-e)+this.to[i]*e;t[i]=t[i]+(n-this.prev),this.prev=n}function s(t,e){for(var i=this.props,n=0;n<this.props.length;n+=1){var s=i[n],r=this.from[s]*(1-e)+this.to[s]*e;t[s]=t[s]+(r-this.prevs[s]),this.prevs[s]=r}}function r(t,e){var i=this.prop,n=this.interps[i](e,this.from[i],this.to[i],this.interpParams[i]);t[i]=t[i]+(n-this.prev),this.prev=n}function o(t,e){for(var i=this.props,n=0;n<i.length;n+=1){var s=i[n],r=this.interps[s](e,this.from[s],this.to[s],this.interpParams[s]);t[s]=t[s]+(r-this.prevs[s]),this.prevs[s]=r}}function a(t,e){e=this.easing(e,this.easingParams);var i=this.prop,n=this.from[i]*(1-e)+this.to[i]*e;t[i]=t[i]+(n-this.prev),this.prev=n}function h(t,e){var i=this.props;e=this.easing(e,this.easingParams);for(var n=0;n<i.length;n+=1){var s=i[n],r=this.from[s]*(1-e)+this.to[s]*e;t[s]=t[s]+(r-this.prevs[s]),this.prevs[s]=r}}function l(t,e){var i=this.prop,n=this.interps[i](this.easing(e,this.easingParams),this.from[i],this.to[i],this.interpParams[i]);t[i]=t[i]+(n-this.prev),this.prev=n}function u(t,e){var i=this.props;e=this.easing(e,this.easingParams);for(var n=0;n<i.length;n+=1){var s=i[n],r=this.interps[s](e,this.from[s],this.to[s],this.interpParams[s]);t[s]=t[s]+(r-this.prevs[s]),this.prevs[s]=r}}function p(t,e,i,n,s,r,o,a,h){this.start=n,this.end=n+s,this.duration=s,this.from=e,this.to=i;var l;r?(l=1,this.easing=r,this.easingParam=o):l=0;var u;null===a?u=0:(u=1,this.interps=a,this.interpParams=h||{});var p;if(1===t.length)p=0,this.prop=t[0],this.props=null,this.prev=0,this.prevs=null;else{p=1,this.prop=null,this.props=t,this.prev=null,this.prevs={};for(var d=0;d<t.length;d+=1)this.prevs[t[d]]=0}this.update=c[l][u][p]}var c=[[[n,s],[r,o]],[[a,h],[l,u]]];e.exports=p},{}],23:[function(t,e,i){function n(t,e){return this instanceof n==!1?new n(t,e):(s.call(this),void r.call(this,t,e))}var s=t("./BriefPlayable"),r=t("./AbstractTween"),o=t("./inherit");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,o(n,r),e.exports=n,n.prototype.to=function(t,e,i,n,s){return r.prototype.to.call(this,t,e,i,n,s),null!==this._player&&this._player._onPlayableChanged(this),this},n.prototype.wait=function(t){return r.prototype.to.wait(this,t),null!==this._player&&this._player._onPlayableChanged(this),this}},{"./AbstractTween":6,"./BriefPlayable":8,"./inherit":27}],24:[function(t,e,i){function n(){s.call(this),this._player=r}var s=t("./Player"),r=t("./TINA");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._inactivate=function(t){this._remove(t)},n.prototype.useAsDefault=function(){return r.setDefaultTweener(this),this}},{"./Player":14,"./TINA":17}],25:[function(t,e,i){var n=Math.PI,s=Math.PI/2,r=2*Math.PI,o=2.718281828;i.none=function(){return 1},i.linear=function(t){return t},i.flash=function(t,e){return t+t*e-t*t*e},i.parabolic=function(t){var e=2*t-1;return 1-e*e},i.trigo=function(t,e){return.5*(1-Math.cos(r*t*e))},i.elastic=function(t,e){if(1===t)return 1;e/=e+1;var i=(1+e)*Math.log(1-t)/Math.log(e);return Math.cos(i-s)*Math.pow(e,i)},i.quadIn=function(t){return t*t},i.quadOut=function(t){return 2*t-t*t},i.quadInOut=function(t){return t<.5?2*t*t:2*(2*t-t*t)-1},i.cubicIn=function(t){return t*t*t},i.cubicOut=function(t){return 3*t-3*t*t+t*t*t},i.cubicInOut=function(t){return t<.5?4*t*t*t:4*(3*t-3*t*t+t*t*t)-3},i.quarticIn=function(t){return t*t*t*t},i.quarticOut=function(t){var e=t*t;return 4*t-6*e+4*e*t-e*e},i.quarticInOut=function(t){if(t<.5)return 8*t*t*t*t;var e=t*t;return 8*(4*t-6*e+4*e*t-e*e)-7},i.polyIn=function(t,e){return Math.pow(t,e)},i.polyOut=function(t,e){return 1-Math.pow(1-t,e)},i.polyInOut=function(t,e){return t<.5?Math.pow(2*t,e)/2:(2-Math.pow(2*(1-t),e))/2},i.sineIn=function(t){return 1-Math.cos(s*t)},i.sineOut=function(t){return Math.sin(s*t)},i.sineInOut=function(t){return t<.5?(1-Math.cos(n*t))/2:(1+Math.sin(n*(t-.5)))/2},i.expIn=function(t,e){return(1-Math.pow(o,e*t))/(1-Math.pow(o,e))},i.expOut=function(t,e){return(1-Math.pow(o,-e*t))/(1-Math.pow(o,-e))},i.expInOut=function(t,e){return t<.5?(1-Math.pow(o,2*e*t))/(1-Math.pow(o,e))/2:.5+(1-Math.pow(o,e-2*e*t))/(1-Math.pow(o,-e))/2},i.circIn=function(t){return 1-Math.sqrt(1-Math.pow(t,2))},i.circOut=function(t){return Math.sqrt(1-Math.pow(1-t,2))},i.circInOut=function(t){return t<.5?(1-Math.sqrt(1-4*t*t))/2:(1+Math.sqrt(-3+8*t-4*t*t))/2},i.elasticIn=function(t,e){if(0===t)return 0;e/=e+1;var i=(1+e)*Math.log(t)/Math.log(e);return Math.cos(i)*Math.pow(e,i)},i.elasticOut=function(t,e){if(1===t)return 1;e/=e+1;var i=(1+e)*Math.log(1-t)/Math.log(e);return 1-Math.cos(i)*Math.pow(e,i)},i.elasticInOut=function(t,e){var i;return t<.5?0===t?0:(e/=e+1,i=(1+e)*Math.log(2*t)/Math.log(e),.5*Math.cos(i)*Math.pow(e,i)):1===t?1:(e/=e+1,i=(1+e)*Math.log(2-2*t)/Math.log(e),.5+.5*(1-Math.cos(i)*Math.pow(e,i)))},i.bounceIn=function(t,e){if(0===t)return 0;e/=e+1;var i=(1+e)*Math.log(t)/Math.log(e);return Math.abs(Math.cos(i)*Math.pow(e,i))},i.bounceOut=function(t,e){if(1===t)return 1;e/=e+1;var i=(1+e)*Math.log(1-t)/Math.log(e);return 1-Math.abs(Math.cos(i)*Math.pow(e,i))},i.bounceInOut=function(t,e){var i;return t<.5?0===t?0:(e/=e+1,i=(1+e)*Math.log(2*t)/Math.log(e),Math.abs(.5*Math.cos(i)*Math.pow(e,i))):1===t?1:(e/=e+1,i=(1+e)*Math.log(2-2*t)/Math.log(e),.5+.5*(1-Math.abs(Math.cos(i)*Math.pow(e,i))))},i.backIn=function(t,e){return t*t*((e+1)*t-e)},i.backOut=function(t,e){return t-=1,t*t*((e+1)*t+e)+1},i.backInOut=function(t,e){return t<.5?(t*=2,.5*(t*t*((e+1)*t-e))):(t=2*t-2,.5*(t*t*((e+1)*t+e))+1)}},{}],26:[function(t,e,i){var n=t("./TINA.js");n.Delay=t("./Delay"),n.BriefExtension=t("./BriefExtension"),n.BriefPlayable=t("./BriefPlayable"),n.BriefPlayer=t("./BriefPlayer"),n.easing=t("./easing"),n.interpolation=t("./interpolation"),n.NestedTween=t("./NestedTween"),n.PixiTween=t("./NestedTween"),n.Playable=t("./Playable"),n.Player=t("./Player"),n.Recorder=t("./Recorder"),n.Sequence=t("./Sequence"),n.Ticker=t("./Ticker"),n.Timeline=t("./Timeline"),n.Timer=t("./Timer"),n.Tween=t("./Tween"),n.Tweener=t("./Tweener"),e.exports=n},{"./BriefExtension":7,"./BriefPlayable":8,"./BriefPlayer":9,"./Delay":10,"./NestedTween":12,"./Playable":13,"./Player":14,"./Recorder":15,"./Sequence":16,"./TINA.js":17,"./Ticker":18,"./Timeline":19,"./Timer":20,"./Tween":23,"./Tweener":24,"./easing":25,"./interpolation":28}],27:[function(t,e,i){e.exports=function(t,e){for(var i=Object.keys(e.prototype),n=0;n<i.length;n+=1){var s=i[n];t.prototype[s]=e.prototype[s]}}},{}],28:[function(t,e,i){i.none=function(t,e,i){return i},i.linear=function(t,e,i){return e*(1-t)+i*t},i.discrete=function(t,e,i,n){return void 0===n&&(n=1),Math.floor((e*(1-t)+i*t)/n)*n},i.vectorXY=function(t,e,i){return{x:e.x*(1-t)+i.x*t,y:e.y*(1-t)+i.y*t}},i.vectorXYZ=function(t,e,i){return{x:e.x*(1-t)+i.x*t,y:e.y*(1-t)+i.y*t,z:e.z*(1-t)+i.z*t}},i.vector=function(t,e,i){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s]*(1-t)+i[s]*t;return n},i.state=function(t,e,i,n){var s=i.length+2,r=Math.floor(t*s);return r<1?e:r>=s-1?i:n[r-1]},i.colorRGB=function(t,e,i){return{r:e.r*(1-t)+i.r*t,g:e.g*(1-t)+i.g*t,b:e.b*(1-t)+i.b*t}},i.colorRGBA=function(t,e,i){return{r:e.r*(1-t)+i.r*t,g:e.g*(1-t)+i.g*t,b:e.b*(1-t)+i.b*t,a:e.a*(1-t)+i.a*t}},i.colorRGBToHexa=function(t,e,i){var n=Math.round(e.r*(1-t)+i.r*t),s=Math.round(e.g*(1-t)+i.g*t),r=Math.round(e.b*(1-t)+i.b*t);return"#"+n.toString(16)+s.toString(16)+r.toString(16)},i.colorRGBToString=function(t,e,i){var n=Math.round(e.r*(1-t)+i.r*t),s=Math.round(e.g*(1-t)+i.g*t),r=Math.round(e.b*(1-t)+i.b*t);return"rgb("+n.toString(16)+","+s.toString(16)+","+r.toString(16)+")"},i.colorRGBAToString=function(t,e,i){var n=Math.round(e.r*(1-t)+i.r*t),s=Math.round(e.g*(1-t)+i.g*t),r=Math.round(e.b*(1-t)+i.b*t),o=Math.round(e.a*(1-t)+i.a*t);return"rgba("+n.toString(16)+","+s.toString(16)+","+r.toString(16)+","+o+")"},i.string=function(t,e,i){for(var n=e.length,s=i.length,r="",o=0;o<s;o+=1){var a=i.charCodeAt(o),h=o>=n?a<97?65:97:e.charCodeAt(o),l=Math.round(h*(1-t)+a*t);r+=String.fromCharCode(l)}return r},i.bezierQuadratic=function(t,e,i,n){var s=1-t;return s*s*e+t*(2*s*n[0]+t*i)},i.bezierCubic=function(t,e,i,n){var s=1-t;return s*s*s*e+t*(3*s*s*n[0]+t*(3*s*n[1]+t*i))},i.bezierQuartic=function(t,e,i,n){var s=1-t,r=2*s;return r*r*e+t*(4*s*r*n[0]+t*(6*r*n[1]+t*(4*s*n[2]+t*i)))},i.bezierQuintic=function(t,e,i,n){var s=1-t,r=2*s;return r*r*s*e+t*(5*r*r*n[0]+t*(10*s*r*n[1]+t*(10*r*n[2]+t*(5*s*n[3]+t*i))))},i.bezier=function(t,e,i,n){var s=n.length,r=1-t,o=i,a=s;for(k=1;k<s;k-=1)o=o*t+a*Math.pow(r,k)*n[s-k],a*=(s-k)/(k+1);return o*t+e*Math.pow(r,s)},i.bezier2d=function(t,e,i,n){for(var s,r,o=n.length,a=1-t,h=i[0],l=i[1],u=o,p=1;p<o;p-=1)s=u*Math.pow(a,p),r=n[o-p],h=h*t+s*r[0],l=l*t+s*r[1],u*=(o-p)/(p+1);return s=Math.pow(a,o),[h*t+e[0]*s,l*t+e[1]*s]},i.bezier3d=function(t,e,i,n){for(var s,r,o=n.length,a=1-t,h=i[0],l=i[1],u=i[2],p=o,c=1;c<o;c-=1)s=p*Math.pow(a,c),r=n[o-c],h=h*t+s*r[0],l=l*t+s*r[1],u=u*t+s*r[2],p*=(o-c)/(c+1);return s=Math.pow(a,o),[h*t+e[0]*s,l*t+e[1]*s,u*t+e[2]*s]},i.bezierKd=function(t,e,i,n){for(var s=n.length,r=1-t,o=e.length,a=[],h=0;h<o;h+=1)a[h]=i[h];for(var l,u,p=s,c=1;c<s;c-=1){for(l=p*Math.pow(r,c),u=n[s-c],h=0;h<o;h+=1)a[h]=a[h]*t+l*u[h];p*=(s-c)/(c+1)}for(l=Math.pow(r,s),h=0;h<o;h+=1)a[h]=a[h]*t+e[h]*l;return a},i.catmullRom=function(t,e,i,n){if(1===t)return n;var s=e.length,r=i.length+1;t*=r;var o=Math.floor(t);t-=o;for(var a=t*t,h=t*a,l=-.5*h+1*a-.5*t,u=1.5*h-2.5*a+1,p=-1.5*h+2*a+.5*t,c=.5*h-.5*a,d=o-2,f=o-1,y=o,v=o+1,m=d<0?e:i[d],g=f<0?e:i[f],_=v<r-2?i[y]:n,w=v<r-2?i[v]:n,x=[],b=0;b<s;b+=1)x[b]=m[b]*l+g[b]*u+_[b]*p+w[b]*c;return x},i.noise=function(){var t=[182,235,131,26,88,132,100,117,202,176,10,19,83,243,75,52,252,194,32,30,72,15,124,53,236,183,121,103,175,39,253,120,166,33,237,141,99,180,18,143,69,136,173,21,210,189,16,142,190,130,109,186,104,80,62,51,165,25,122,119,42,219,146,61,149,177,54,158,27,170,60,201,159,193,203,58,154,222,78,138,220,41,98,14,156,31,29,246,81,181,40,161,192,227,35,241,135,150,89,68,134,114,230,123,187,179,67,217,71,218,7,148,228,251,93,8,140,125,73,37,82,28,112,24,174,118,232,137,191,133,147,245,6,172,95,113,185,205,254,116,55,198,57,152,128,233,74,225,34,223,79,111,215,85,200,9,242,12,167,44,20,110,107,126,86,231,234,76,207,102,214,238,221,145,213,64,197,38,168,157,87,92,255,212,49,196,240,90,63,0,77,94,1,108,91,17,224,188,153,250,249,199,127,59,46,184,36,43,209,206,248,4,56,47,226,13,144,22,11,247,70,244,48,97,151,195,96,101,45,66,239,178,171,160,84,65,23,3,211,162,163,50,105,129,155,169,115,5,106,2,208,204,139,229,164,216,182],e=[-1,1];return function(i,n,s,r){for(var o=2,a=r.per||1,h=r.frq||2,l=r.oct||4,u=r.off||0,p=0,c=r.x+u,d=0;d<l;d+=1){var f=255&(c|c),y=c-(c|c),v=1-y;p+=o*(v*v*y*(3-2*v)*e[1&t[f]]-y*y*v*(3-2*y)*e[1&t[f+1]]),c*=(c-u)*h+u,o*=a}var m=1===a?1/l:.5*(1-a)/(1-Math.pow(a,l));return i+=p*m,n*(1-i)+s*i}}(),i.simplex2d=function(){function t(t,e,i){return t[0]*e+t[1]*i}var e=[182,235,131,26,88,132,100,117,202,176,10,19,83,243,75,52,252,194,32,30,72,15,124,53,236,183,121,103,175,39,253,120,166,33,237,141,99,180,18,143,69,136,173,21,210,189,16,142,190,130,109,186,104,80,62,51,165,25,122,119,42,219,146,61,149,177,54,158,27,170,60,201,159,193,203,58,154,222,78,138,220,41,98,14,156,31,29,246,81,181,40,161,192,227,35,241,135,150,89,68,134,114,230,123,187,179,67,217,71,218,7,148,228,251,93,8,140,125,73,37,82,28,112,24,174,118,232,137,191,133,147,245,6,172,95,113,185,205,254,116,55,198,57,152,128,233,74,225,34,223,79,111,215,85,200,9,242,12,167,44,20,110,107,126,86,231,234,76,207,102,214,238,221,145,213,64,197,38,168,157,87,92,255,212,49,196,240,90,63,0,77,94,1,108,91,17,224,188,153,250,249,199,127,59,46,184,36,43,209,206,248,4,56,47,226,13,144,22,11,247,70,244,48,97,151,195,96,101,45,66,239,178,171,160,84,65,23,3,211,162,163,50,105,129,155,169,115,5,106,2,208,204,139,229,164,216,182,235,131,26,88,132,100,117,202,176,10,19,83,243,75,52,252,194,32,30,72,15,124,53,236,183,121,103,175,39,253,120,166,33,237,141,99,180,18,143,69,136,173,21,210,189,16,142,190,130,109,186,104,80,62,51,165,25,122,119,42,219,146,61,149,177,54,158,27,170,60,201,159,193,203,58,154,222,78,138,220,41,98,14,156,31,29,246,81,181,40,161,192,227,35,241,135,150,89,68,134,114,230,123,187,179,67,217,71,218,7,148,228,251,93,8,140,125,73,37,82,28,112,24,174,118,232,137,191,133,147,245,6,172,95,113,185,205,254,116,55,198,57,152,128,233,74,225,34,223,79,111,215,85,200,9,242,12,167,44,20,110,107,126,86,231,234,76,207,102,214,238,221,145,213,64,197,38,168,157,87,92,255,212,49,196,240,90,63,0,77,94,1,108,91,17,224,188,153,250,249,199,127,59,46,184,36,43,209,206,248,4,56,47,226,13,144,22,11,247,70,244,48,97,151,195,96,101,45,66,239,178,171,160,84,65,23,3,211,162,163,50,105,129,155,169,115,5,106,2,208,204,139,229,164,216],i=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[1,0],[-1,0],[0,1],[0,-1],[0,1],[0,-1],[1,1],[-1,1],[1,-1],[-1,-1]];return function(n,s,r,o){for(var a=2,h=o.per||1,l=o.frq||2,u=o.oct||4,p=o.off||{x:0,y:0},c=c,d=o.x+p.x,f=o.y+p.y,y=0;y<u;y+=1){var v,m,g,_=.5*(Math.sqrt(3)-1),w=(d+f)*_,x=Math.floor(d+w),b=Math.floor(f+w),T=(3-Math.sqrt(3))/6,S=(x+b)*T,M=x-S,P=b-S;M=d-M,P=f-P;var R,A;M>P?(R=1,A=0):(R=0,A=1);var C=M-R+T,B=P-A+T,j=M-1+2*T,O=P-1+2*T,k=255&x,I=255&b,L=.5-M*M-P*P,E=.5-C*C-B*B,D=.5-j*j-O*O;if(L<0)v=0;else{var V=15&e[k+e[I]];L*=L,v=L*L*t(i[V],M,P)}if(E<0)m=0;else{var z=15&e[k+R+e[I+A]];E*=E,m=E*E*t(i[z],C,B)}if(D<0)g=0;else{var F=15&e[k+1+e[I+1]];D*=D,g=D*D*t(i[F],j,O)}c+=70*a*(v+m+g),d*=(d-p.x)*l+p.x,f*=(f-p.y)*l+p.y,a*=h}var N=1===h?1/u:.5*(1-h)/(1-Math.pow(h,u));
return n+=c*N,s*(1-n)+r*n}}()},{}],29:[function(t,e,i){e.exports={screen:{width:160,height:136,pixelSize:[3,2],fullscreen:!1},tileSize:[8,8],palette:["#183725","#416E2B","#9FBB32","#CFE581"],controls:{up:38,down:40,left:37,right:39,start:13,A:48,B:187}}},{}],30:[function(t,e,i){function n(t,e){return t.x<e.x+e.w&&t.y<e.y+e.h&&e.x<t.x+t.w&&e.y<t.y+t.h}e.exports=n},{}],31:[function(t,e,i){function n(t){this.x=0,this.y=0,this.w=2,this.h=2,this.owner=t,this.reset()}var s=t("./level"),r=t("./view/gameView"),o=t("./AABBcollision"),a=assets.entity.banana,h=settings.tileSize[0],l=settings.tileSize[1],u=.9,p=.01,c=.8,d=20,f=3,y=.433,v=1.369;e.exports=n,n.prototype.reset=function(){audioManager.stopLoopSound("banana"),this.sx=0,this.sy=0,this.grabbing=null,this.flying=!1,this.throwing=!1,this.throwCounter=0,this.frame=0},n.prototype.draw=function(){var t=a.idle;this.flying&&(this.frame+=.2,this.frame>=4&&(this.frame=0),t=a["fly"+~~this.frame]),draw(t,this.x-4,this.y-4)},n.prototype.maxSpeed=function(){this.sx>f&&(this.sx=f),this.sx<-f&&(this.sx=-f),this.sy>f&&(this.sy=f),this.sy<-f&&(this.sy=-f)},n.prototype.update=function(){this.throwing?(this.throwCounter++>d&&(this.throwing=!1),this.levelCollisions()):this.flying?(this.sx+=clip((this.owner.x-this.x)*p,-c,c),this.sy+=clip((this.owner.y-this.y)*p,-c,c),this.sx*=u,this.sy*=u,this.maxSpeed(),this.levelCollisions(),o(this,this.owner)&&this._catchBanana()):(this.x=this.owner.x+3,this.y=this.owner.y-5),this.grabbing&&(this.grabbing.x=this.x-2,this.grabbing.y=this.y-6)},n.prototype.levelCollisions=function(){var t=this.x+this.sx,e=this.y+this.sy,i=s.width*h;this.sx<0&&t<0&&(t=0,this.sx*=-1),this.sx>0&&t>i&&(t=i,this.sx*=-1),s.getTileAt(t,this.y).fruitSolid&&(this.sx*=-1,t=this.x),s.getTileAt(this.x,e).fruitSolid&&(this.sy*=-1,e=this.y),this.x=t,this.y=e},n.prototype.getTeleportPosition=function(){if(s.getTileAt(this.x,this.y).isSolid)return null;var t=this.x-3,e=this.y-3,i=this.owner,n=i.w,r=i.h;if(s.getTileAt(t,e).isTeleportable&&s.getTileAt(t+n,e).isTeleportable&&s.getTileAt(t,e+r).isTeleportable&&s.getTileAt(t+n,e+r).isTeleportable)return{x:t,y:e};var o=~~(t/h)*h,a=~~(e/l)*l;return s.getTileAt(o,a).isTeleportable?{x:o,y:a}:s.getTileAt(o+h,a).isTeleportable?{x:o+h,y:a}:s.getTileAt(o,a+l).isTeleportable?{x:o,y:a+l}:s.getTileAt(o+h,a+l).isTeleportable?{x:o+h,y:a+l}:void 0},n.prototype.fire=function(t,e){s.getTileAt(this.x,this.y).fruitSolid||(audioManager.playLoopSound("banana","banana fly",1,0,0,y,v),this.flying=!0,this.throwing=!0,this.throwCounter=0,this.sx=t,this.sy=e,this.maxSpeed())},n.prototype.grab=function(t){this.grabbing||(sfx("catch"),this.grabbing=t,r.removeEntityFromCollisions(t))},n.prototype._catchBanana=function(){sfx("catch"),this.flying=!1,audioManager.stopLoopSound("banana"),this.grabbing&&(this.grabbing.collectItem(this.owner),this.grabbing=null)}},{"./AABBcollision":30,"./level":48,"./view/gameView":55}],32:[function(t,e,i){function n(t){this.x=0,this.y=0,this.w=d,this.h=f,this.gamepadIndex=t||0,this.banana=new a(this),this.maxLife=4,this.lifePoints=this.maxLife,this.sprite=16*t,this.reset()}var s=t("./viewManager"),r=t("./view/gameView"),o=t("./level"),a=t("./Banana"),h=t("./AABBcollision"),l=t("./tiles"),u=t("./speedrun"),p=assets.entity.monkey,c=assets.entity.arrow,d=settings.tileSize[0],f=settings.tileSize[1],y=.5,v=3,m=1,g=4;e.exports=n,n.prototype.reset=function(){this.sx=0,this.sy=0,this.dx=0,this.dy=0,this.hasKey=!1,this.onTile=l.EMPTY,this.aiming=!1,this.jumping=!1,this.grounded=!1,this.isLocked=!1,this.isHit=!1,this.jumpCounter=0,this.hitCounter=0,this.frame=0,this.flipH=!1,this.banana.reset()},n.prototype.draw=function(){this.aiming&&draw(c[""+this.dx+this.dy],this.x-16,this.y-20);var t=p.idle;this.isHit&&this.isLocked?t=p.hit:this.jumping?t=p.jump:(this.sx>.5||this.sx<-.5)&&(this.frame+=.3,this.frame>=3&&(this.frame=0),t=p["run"+~~this.frame]),draw(t,this.x-1,this.y-1,this.flipH),this.banana.draw()},n.prototype.update=function(t){this._updateControls(t),this.sx*=this.isHit?.99:.8,this.grounded||(this.sy+=y,this.sy=Math.min(this.sy,v)),this.isHit&&(this.hitCounter++,this.hitCounter>16&&(this.lifePoints<=0&&this.death(),this.isLocked=!1),this.hitCounter>50&&(this.isHit=!1)),this.levelCollisions(),this.banana.update()},n.prototype.aim=function(t){this.banana.flying||(this.aiming=!0,this.dx=0,this.dy=0,t.btn.right&&(this.dx+=1,this.flipH=!1),t.btn.left&&(this.dx-=1,this.flipH=!0),t.btn.down&&(this.dy+=1),t.btn.up&&(this.dy-=1),0===this.dx&&0===this.dy&&(this.dx=this.flipH?-1:1))},n.prototype.teleport=function(){if(this.banana.flying){var t=this.banana.getTeleportPosition();t&&(sfx("teleport"),this.banana.x=this.x+4,this.banana.y=this.y+4,this.x=t.x,this.y=t.y,this.grounded=!1)}},n.prototype.startJump=function(){this.grounded&&(sfx("jump"),this.grounded=!1,this.jumping=!0,this.jumpCounter=0)},n.prototype.jump=function(){this.jumping&&(this.jumpCounter++>12&&(this.jumping=!1),this.sy=-3+.08*this.jumpCounter)},n.prototype._updateControls=function(t){if(!this.isLocked){if(t.btnr.B&&!this.banana.flying&&(this.aiming=!1,this.banana.fire(this.dx*g,this.dy*g)),t.btnp.B&&this.banana.flying&&this.teleport(),t.btnp.A&&this.startJump(),t.btnr.A&&(this.jumping=!1),t.btn.A&&this.jump(),t.btn.B)return this.aim(t);t.btn.right&&!t.btn.left&&(this.sx=m,this.flipH=!1),t.btn.left&&!t.btn.right&&(this.sx=-m,this.flipH=!0),t.btnp.up&&!t.btn.right&&!t.btn.left&&this.onTile.interactive&&this.useInteractive();var e=this.onTile=o.getTileAt(this.x+4,this.y+4);return e.kill?this.death():void 0}},n.prototype.levelCollisions=function(){this.sx=~~(100*this.sx)/100,this.sy=~~(100*this.sy)/100;var t=this.x+this.sx,e=this.y+this.sy,i=o.width*d-this.w,n=o.height*f+64;if(t<0&&(t=0),t>i&&(t=i),e>n)return sfx("fall"),void this.death();var s=this.w,r=0;if(this.sx<0&&(s=0,r=this.w),0!==this.sx?(o.getTileAt(t+s,this.y+1).isSolid||o.getTileAt(t+s,this.y+this.h-1).isSolid)&&(this.sx=0,t=~~(t/d)*d+r):t=Math.round(t),this.grounded){var a=o.getTileAt(t+1,e+this.h+1),h=o.getTileAt(t+this.w-2,e+this.h+1);a.isEmpty&&h.isEmpty&&(this.grounded=!1)}else if(this.sy>0){var a=o.getTileAt(t+1,e+this.h),h=o.getTileAt(t+this.w-2,e+this.h);if(a.isSolid||h.isSolid)this._ground(),e=~~(e/f)*f;else if(a.isTopSolid||h.isTopSolid){var l=~~(e/f)*f;this.y<=l&&(this._ground(),e=l)}}else if(this.sy<0){var u=o.getTileAt(t+1,e),p=o.getTileAt(t+this.w-2,e);(u.isSolid||p.isSolid)&&(this.sy=0,e=~~(e/f)*f+this.w)}this.x=t,this.y=e},n.prototype._ground=function(){this.grounded=!0,this.jumping=!1,this.sy=0},n.prototype.checkCollisionWithEntity=function(t){var e=this.banana;t.collisionMonkey&&h(this,t)&&t.collisionMonkey(this),e.flying&&t.collisionBanana&&h(e,t)&&t.collisionBanana(e)},n.prototype.hit=function(t){this.isHit||(sfx("hit"),this.sx=t.x<this.x?1.6:-1.6,this.sy=t.y<this.y?2:-3,this.aiming=!1,this.grounded=!1,this.isLocked=!0,this.isHit=!0,this.hitCounter=0,this.lifePoints-=1,r.shakeCamera(3),r.updateHealthHUD())},n.prototype.death=function(){audioManager.stopLoopSound("banana"),this.lifePoints=this.maxLife,this.isHit=!0,this.isLocked=!0,u.death(),s.open("gameover")},n.prototype.useInteractive=function(){this.onTile.door&&r.gotoNextLevel()}},{"./AABBcollision":30,"./Banana":31,"./level":48,"./speedrun":51,"./tiles":52,"./view/gameView":55,"./viewManager":63}],33:[function(t,e,i){function n(t,e){t=t||{},this.controller=e||s,this.x=0,this.y=0,this.sx=0,this.sy=0,this.frame=0,this.life=0,this.flipH=!1,this.flipV=!1,this.animation=t.animation,this.animSpeed=t.animSpeed||0,this.lifetime=t.lifetime||this.animation.length/this.animSpeed,this.gravity=t.gravity||0,this.controller.addEntity(this)}var s=t("./view/gameView");e.exports=n,n.prototype.draw=function(){if(this.life+=1,this.life>=this.lifetime)return void this.controller.removeEntity(this);this.sy+=this.gravity,this.x+=this.sx,this.y+=this.sy,this.frame+=this.animSpeed,this.frame>=this.animation.length&&(this.frame=0);var t=this.animation[~~this.frame];draw(t,this.x,this.y,this.flipH,this.flipV)}},{"./view/gameView":55}],34:[function(t,e,i){function n(t,e){this.x=0,this.y=0,this.frame=0,this.flipH=!1,this.flipV=!1,this.animSpeed=e||.2,this.animation=t}var s=t("./view/gameView");e.exports=n,n.prototype.draw=function(){if(this.frame+=this.animSpeed,this.frame>=this.animation.length)return void s.removeEntity(this);var t=this.animation[~~this.frame];"number"==typeof t?sprite(t,this.x,this.y,this.flipH,this.flipV):draw(t,this.x,this.y,this.flipH,this.flipV)},n.prototype.setAnimation=function(t,e){return this.animation=t,this.animSpeed=e||this.animSpeed||.2,this},n.prototype.setPosition=function(t,e){return this.x=t,this.y=e,this}},{"./view/gameView":55}],35:[function(t,e,i){function n(t,e,i,n){this.w=t,this.h=e,this.paper=0,this.color=0,this.texture=new s(t,e),this.texture.setTilesheet(i)}var s=t("Texture"),r=settings.tileSize[0],o=(settings.tileSize[1],32);e.exports=n,n.prototype.clear=function(){return this.texture.clear(),this},n.prototype.cls=function(){return this.texture.paper(this.paper),this.texture.cls(),this},n.prototype.addText=function(t,e,i){for(var n=0;n<t.length;n++){var s=t.charCodeAt(n),a=64*this.color+s-o;this.texture.sprite(a,e,i),e+=r}return this},n.prototype.setColor=function(t){return this.color=~~t%4,this}},{Texture:3}],36:[function(t,e,i){i.explosion=[assets.entity.explosion.frame0,assets.entity.explosion.frame1,assets.entity.explosion.frame2,assets.entity.explosion.frame3,assets.entity.explosion.frame4,assets.entity.explosion.frame5,assets.entity.explosion.frame6,assets.entity.explosion.frame7,assets.entity.explosion.frame8],i.getFX=[assets.entity.getFX.frame0,assets.entity.getFX.frame1,assets.entity.getFX.frame2,assets.entity.getFX.frame3,assets.entity.getFX.frame4,assets.entity.getFX.frame5,assets.entity.getFX.frame6]},{}],37:[function(t,e,i){audioManager.loadSound("jump"),audioManager.loadSound("teleport"),audioManager.loadSound("catch"),audioManager.loadSound("wrong"),audioManager.loadSound("explosion"),audioManager.loadSound("fall"),audioManager.loadSound("hit"),audioManager.loadSound("item"),audioManager.loadSound("bounce")},{}],38:[function(t,e,i){function n(t){this.x=0,this.y=0,this.w=8,this.h=8,this.sx=0,this.sy=0,this.sleeping=!0,this.frame=random(f)}var s=t("../view/gameView"),r=t("../ShortAnimation"),o=t("../animations"),a=(t("../level"),t("./ItemLife")),h=(settings.tileSize[0],settings.tileSize[1],.2),l=[assets.entity.bat.fly0,assets.entity.bat.fly1,assets.entity.bat.fly2,assets.entity.bat.fly1],u=.9,p=.01,c=.03,d=.5,f=l.length;e.exports=n,n.prototype.draw=function(){var t=s.monkey;if(this.sleeping)return draw(assets.entity.bat.hang0,this.x,this.y),void(Math.abs(t.x-this.x)<24&&t.y>this.y&&t.y-this.y<64&&(this.sleeping=!1));var e=t.x+4,i=t.y-4;this.sx+=clip((e-this.x)*p,-c,c),this.sy+=clip((i-this.y)*p,-c,c),this.sx*=u,this.sy*=u,this.sx>d&&(this.sx=d),this.sx<-d&&(this.sx=-d),this.sy>d&&(this.sy=d),this.sy<-d&&(this.sy=-d);var n=this.x+this.sx,r=this.y+this.sy;this.x=n,this.y=r,this.frame+=h,this.frame>=f&&(this.frame=0),draw(l[~~this.frame],this.x-7,this.y-3)},n.prototype.collisionBanana=function(t){sfx("explosion"),s.removeEntity(this);var e=new r(o.explosion,.5);if(e.setPosition(this.x-8,this.y-8),s.addEntity(e,!1),Math.random()<.3){var i=new a;i.sy=-1,i.x=~~this.x,i.y=~~this.y,s.addEntity(i,!0)}},n.prototype.collisionMonkey=function(t){t.hit(this)}},{"../ShortAnimation":34,"../animations":36,"../level":48,"../view/gameView":55,"./ItemLife":43}],39:[function(t,e,i){function n(){this.x=0,this.y=0,this.sx=0,this.sy=0,this.frame=0}var s=.2;e.exports=n,n.prototype.draw=function(){this.x+=this.sx,this.y+=this.sy,this.frame+=s,this.frame>=2&&(this.frame=0),sprite(230,this.x,this.y,!1,this.frame>1)}},{}],40:[function(t,e,i){function n(t){t=t||{},this.hx=t.x,this.hy=t.y,this.x=0,this.y=0,this.w=8,this.h=8,this.a=0,this.frame=0}var s=(t("../level"),t("../Particle")),r=(settings.tileSize[0],settings.tileSize[1],.05),o=2*Math.PI,a=32,h=[assets.entity.chainedBall.ball0,assets.entity.chainedBall.ball1],l=[assets.entity.chainedBall.particle0,assets.entity.chainedBall.particle1,assets.entity.chainedBall.particle2],u={animation:l,animSpeed:.2,lifetime:null,gravity:0},p=h.length,c=.5;e.exports=n,n.prototype.draw=function(){this.a+=r,this.a>o&&(this.a-=o);var t=Math.cos(this.a),e=Math.sin(this.a);if(this.x=this.hx+t*a-4,this.y=this.hy+e*a-4,this.frame+=c,this.frame>=p){this.frame=0;var i=new s(u);i.x=this.x,i.y=this.y,i.sx=.2*(Math.random()-.5),i.sy=.2*(Math.random()-.5)}draw(h[~~this.frame],this.x-1,this.y-1)},n.prototype.collisionMonkey=function(t){t.hit(this)}},{"../Particle":33,"../level":48}],41:[function(t,e,i){function n(t){t=t||{},this.x=0,this.y=0,this.w=a,this.h=h,this.ox=t.offsetX||0,this.oy=t.offsetY||0,this.sprites=t.sprites,this.frame=0,this.animated=this.sprites.length>1}var s=t("../view/gameView"),r=t("../ShortAnimation"),o=t("../animations"),a=settings.tileSize[0],h=settings.tileSize[1],l=.2;e.exports=n,n.prototype.draw=function(){this.animated&&(this.frame+=l,this.frame>=this.sprites.length&&(this.frame=0));var t=this.sprites[~~this.frame];draw(t,this.x+this.ox,this.y+this.oy)},n.prototype.collisionBanana=function(t){t.grab(this)},n.prototype.collisionMonkey=function(t){this.collectItem(t)},n.prototype.collectItem=function(t){sfx("item"),s.removeEntity(this);var e=new r(o.getFX,.4);e.setPosition(this.x-12,this.y-12),s.addEntity(e,!1)}},{"../ShortAnimation":34,"../animations":36,"../view/gameView":55}],42:[function(t,e,i){function n(){r.call(this,a)}var s=t("../view/gameView"),r=t("./Item"),o=[assets.entity.item.key0,assets.entity.item.key1,assets.entity.item.key2,assets.entity.item.key4,assets.entity.item.key5,assets.entity.item.key6,assets.entity.item.key7,assets.entity.item.key8,assets.entity.item.key9,assets.entity.item.key10,assets.entity.item.key11,assets.entity.item.key12],a={sprites:o,offsetX:-1,offsetY:-1};inherits(n,r),e.exports=n,n.prototype.collectItem=function(t){r.prototype.collectItem.call(this,t),t.hasKey=!0,s.displayMessage("   YOU FOUND A KEY")}},{"../view/gameView":55,"./Item":41}],43:[function(t,e,i){function n(){r.call(this,l),this.grounded=!1,this.rebound=0,this.sy=0,this.isLocked=!0,this.lockedCounter=30}var s=t("../view/gameView"),r=t("./Item"),o=t("../level"),a=(settings.tileSize[0],settings.tileSize[1]),h=[assets.entity.item.life0,assets.entity.item.life1,assets.entity.item.life2,assets.entity.item.life3,assets.entity.item.life4,assets.entity.item.life5,assets.entity.item.life6,assets.entity.item.life7,assets.entity.item.life8],l={sprites:h,offsetX:-2,offsetY:-3},u=.15,p=2.5,c=.7;inherits(n,r),e.exports=n,n.prototype.draw=function(){if(this.isLocked&&this.lockedCounter--<=0&&(this.isLocked=!1),!this.grounded){this.sy+=u,this.sy=Math.min(this.sy,p);var t=this.y+this.sy;o.getTileAt(this.x+4,t+8).isTopSolid&&(t=this.y,this.sy*=-c,this.rebound+=1,sfx("bounce",Math.min(1,-this.sy)),this.rebound>3&&(this.grounded=!0,t=~~(this.y/a+1)*a)),this.y=t}r.prototype.draw.call(this)},n.prototype.collisionBanana=function(t){this.isLocked||t.grab(this)},n.prototype.collectItem=function(t){r.prototype.collectItem.call(this,t),t.lifePoints<t.maxLife&&(t.lifePoints+=1),s.updateHealthHUD()}},{"../level":48,"../view/gameView":55,"./Item":41}],44:[function(t,e,i){function n(t){this.x=0,this.y=0,this.w=o,this.h=a,this.frame=0,this.directionId=0,this.direction=u[0],this.moveCounter=0,this.freezed=!1,this.freezeCounter=0}function s(t,e,i,n){return t.getTile(e+n.x,i+n.y)}var r=(t("../view/gameView"),t("../level")),o=settings.tileSize[0],a=settings.tileSize[1],h=.2,l=240,u=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}],p=[assets.entity.spark.frame0,assets.entity.spark.frame1];e.exports=n,n.prototype.draw=function(){return this.freezed?(this.freezeCounter++>=l&&(this.freezed=!1),void draw(p[~~this.frame],this.x-1,this.y-1)):(this.x+=this.direction.x,this.y+=this.direction.y,this.moveCounter+=1,this.moveCounter>=o&&(this.moveCounter=0,this._getNextMove()),this.frame+=h,this.frame>=2&&(this.frame=0),void draw(p[~~this.frame],this.x-1,this.y-1))},n.prototype.collisionBanana=function(t){this.freezed=!0,this.freezeCounter=0},n.prototype.collisionMonkey=function(t){t.hit(this)},n.prototype._getNextMove=function(){var t=~~(this.x/o),e=~~(this.y/a),i=(this.direction,(this.directionId+1)%4),n=u[i];if(s(r,t,e,n).isEmpty)return this.directionId=i,void(this.direction=n);for(;s(r,t,e,this.direction).isSolid;)this.directionId=this.directionId-1,this.directionId<0&&(this.directionId=3),this.direction=u[this.directionId]}},{"../level":48,"../view/gameView":55}],45:[function(t,e,i){function n(t){this.x=0,this.y=0,this.w=8,this.h=8,this.sx=l,this.sy=0,this.frame=random(p)}var s=t("../view/gameView"),r=t("../ShortAnimation"),o=t("../animations"),a=t("../level"),h=t("./ItemLife"),l=(settings.tileSize[0],settings.tileSize[1],.1),u=[assets.entity.worm.walk0,assets.entity.worm.walk1,assets.entity.worm.walk2,assets.entity.worm.walk3,assets.entity.worm.walk2,assets.entity.worm.walk1],p=u.length;e.exports=n,n.prototype.draw=function(){var t=this.x,e=this.y;t+=this.sx,(this.sx>0&&a.getTileAt(t+this.w,this.y).isSolid||this.sx>0&&a.getTileAt(t+this.w,this.y+this.h).isEmpty||this.sx<0&&a.getTileAt(t+4,this.y).isSolid||this.sx<0&&a.getTileAt(t+4,this.y+this.h).isEmpty)&&(t=this.x,this.sx*=-1),this.x=t,this.y=e,this.frame+=l,this.frame>=p&&(this.frame=0),draw(u[~~this.frame],this.x-3,this.y)},n.prototype.collisionBanana=function(t){sfx("explosion"),s.removeEntity(this);var e=new r(o.explosion,.5);if(e.setPosition(this.x-8,this.y-8),s.addEntity(e,!1),Math.random()<.1){var i=new h;i.sy=-2,i.x=~~this.x,i.y=~~this.y,s.addEntity(i,!0)}},n.prototype.collisionMonkey=function(t){t.hit(this)}},{"../ShortAnimation":34,"../animations":36,"../level":48,"../view/gameView":55,"./ItemLife":43}],46:[function(t,e,i){function n(t,e,i,n){e=e||{},e.x=i.x*c,e.y=i.y*d;var r=new t(e);return r.x=e.x,r.y=e.y,s.addEntity(r,n),r}var s=(t("../level"),t("../view/gameView")),r=t("./ItemKey"),o=t("./ItemLife"),a=t("./Butterfly"),h=t("./Worm"),l=t("./Spark"),u=t("./ChainedBall"),p=t("./Bat"),c=settings.tileSize[0],d=settings.tileSize[1];i.createEntityfromMapItem=function(t){switch(t.tile){case 32:case 33:return n(r,null,t,!0);case 34:return n(o,null,t,!0);case 48:return n(a,null,t,!1);case 64:return n(l,null,t,!0);case 65:return n(h,null,t,!0);case 66:case 67:return n(u,null,t,!0);case 68:return n(p,null,t,!0);default:return null}}},{"../level":48,"../view/gameView":55,"./Bat":38,"./Butterfly":39,"./ChainedBall":40,"./ItemKey":42,"./ItemLife":43,"./Spark":44,"./Worm":45}],47:[function(t,e,i){function n(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}function s(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var i=t[e],n=h[e];if(i){n.available=!0;for(var s=0;s<o.length;s++){var r=o[s],a=i.buttons[s].pressed;n.btnp[r]=!n.btn[r]&&a,n.btnr[r]=n.btn[r]&&!a,n.btn[r]=a}n.x=i.axes[0],n.y=i.axes[1],n.z=i.axes[2],n.w=i.axes[3],n.lt=i.buttons[6].value,n.rt=i.buttons[7].value}else n.available=!1}return h}function r(){return h}var o=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],a=!(!navigator||!navigator.getGamepads);n.prototype._setupButtons=function(){for(var t=0;t<o.length;t++){var e=o[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var h=[new n,new n,new n,new n],l=new n;i.getAllGamepads=a?s:r,i.getAnyGamepad=function(){i.getAllGamepads();for(var t=0;t<o.length;t++){var e=o[t];l.btnp[e]=btnp[e]||h[0].btnp[e]||h[1].btnp[e]||h[2].btnp[e]||h[3].btnp[e],l.btnr[e]=btnr[e]||h[0].btnr[e]||h[1].btnr[e]||h[2].btnr[e]||h[3].btnr[e],l.btn[e]=btn[e]||h[0].btn[e]||h[1].btn[e]||h[2].btn[e]||h[3].btn[e]}return l};var u=0;i.setInpuMode=function(t){u=t},i.getGamepad=function(){return u===-1?window:s()[u]}},{}],48:[function(t,e,i){var n=t("Map"),s=t("Texture"),r=t("./tiles"),o=t("./entity/entities"),a=settings.tileSize[0],h=settings.tileSize[1],l=i;l.width=20,l.height=18,l.background=null,l.layer=new s(l.width*a,l.height*h),l.geometry=new n(l.width,l.height),i.load=function(t){var e=t+"/";l.geometry=getMap(e+"G"),l.geometry||console.error("Could not find map",e+"G"),l.width=l.geometry.width,l.height=l.geometry.height;var i=l.width*a,n=l.height*h;l.background=getMap(e+"B"),l.layer.resize(i,n),l.layer.clear();for(var s=0,r=getMap(e+"L"+s);r;)l.layer.draw(r),r=getMap(e+"L"+ ++s);for(var u=0;u<l.width;u++)for(var p=0;p<l.height;p++){var c=l.geometry.get(u,p);c&&o.createEntityfromMapItem(c)}return l},i.drawBackground=function(){l.background&&draw(l.background,0,0)},i.draw=function(){draw(l.layer,0,0)},i.getTileAt=function(t,e){return t=~~(t/a),e=~~(e/h),t<0?t=0:t>=l.width&&(t=l.width-1),e<0?e=0:e>=l.height&&(e=l.height-1),r.getTileFromMapItem(l.geometry.get(t,e))},i.getTile=function(t,e){return t<0?t=0:t>=l.width&&(t=l.width-1),e<0?e=0:e>=l.height&&(e=l.height-1),r.getTileFromMapItem(l.geometry.get(t,e))},i.getEntryPoints=function(){var t=l.geometry.find(255),e=l.geometry.find(16),i=l.geometry.find(32),n=l.geometry.find(33),s=!(!i.length&&!n.length);return 1===t.length&&1===e.length||console.log("Level entry points miss configured"),{entry:t[0],exit:e[0],needKey:s}}},{"./entity/entities":46,"./tiles":52,Map:2,Texture:3}],49:[function(t,e,i){audioManager.settings.defaultFade=.01,audioManager.addChannel("banana");var n=t("./viewManager");n.addView("splash",t("./view/splashView")),n.addView("title",t("./view/titleView")),n.addView("password",t("./view/passwordView")),n.addView("game",t("./view/gameView")),n.addView("pause",t("./view/pauseView")),n.addView("intermission",t("./view/intermissionView")),n.addView("credit",t("./view/creditView")),n.addView("gameover",t("./view/gameoverView")),n.addView("ending",t("./view/endingView")),n.addView("speedrunResult",t("./view/speedrunResultView")),n.open("splash"),t("./audioPreloading"),i.update=n.update},{"./audioPreloading":37,"./view/creditView":53,"./view/endingView":54,"./view/gameView":55,"./view/gameoverView":56,"./view/intermissionView":57,"./view/passwordView":58,"./view/pauseView":59,"./view/speedrunResultView":60,"./view/splashView":61,"./view/titleView":62,"./viewManager":63}],50:[function(t,e,i){function n(t){if(5!=t.length)return null;for(var e=[],i=0;i<t.length;i++){var n=t[i],s=u[n];if(void 0===s)return null;for(var r=0;r<5;r++){var o=s>>r&1;e.push(!!o)}}return e}function s(t){if(25!==t.length)return null;for(var e="",i=0;i<5;i++){for(var n=0,s=0;s<5;s++){var r=t[5*i+s];r&&(n+=1<<s)}e+=l[n]}return e}function r(){this.matrix=new Array(25),this.grid=new o(5,5).setTilesheet(assets.tilesheet)}var o=t("Map"),a=getMap("passGrid"),h=7,l=".D*Rw<4yAp1ilc83-z>q#t02rxBj+CkE",u={};!function(){for(var t=0;t<l.length;t++){var e=l[t];u[e]=t}}(),e.exports=r,r.prototype.setPassword=function(t){var e=n(t);for(x=0;x<5;x++)for(y=0;y<5;y++){var i=e[5*x+y];i?this.grid.set(x,y,h):this.grid.remove(x,y)}},r.prototype.getPassword=function(){return s(this.matrix)},r.prototype.switchBit=function(t,e){this.grid.get(t,e)?(this.grid.remove(t,e),this.matrix[5*t+e]=!1):(this.grid.set(t,e,h),this.matrix[5*t+e]=!0)},r.prototype.draw=function(t,e){draw(a,t,e),draw(this.grid,t+8,e+8)}},{Map:2}],51:[function(t,e,i){function n(t){this.data=t,this.frame=0,this.death=0}var s=t("./TextBox"),r=60,o=60*r,a=assets.levels,h={index:-1,level:null,chapter:null};!function(){for(var t={chapter:0,title:""},e=1,i=0;i<assets.levels.length;i++){var n=assets.levels[i];n.intermission?t=assets.levels[i]:(n.chapter=t,n.stage=e++)}}(),n.prototype.getTime=function(){var t=this.frame,e=~~(t/o);t-=e*o;var i=~~(t/r);t-=i*r;var n=~~(100*t/r),s=("0"+e).slice(-2)+":"+("0"+i).slice(-2)+"."+("0"+n).slice(-2);return s};var l,u,p,c=new s(64,8,assets.font.tetris).setColor(0);c.paper=0,e.exports.reset=function(){u=new n(h),l=[];for(var t=0;t<a.length;t++)l.push(new n(a[t]));p=l[0]},e.exports.setLevel=function(t){p=l[t]},e.exports.update=function(){u.frame+=1,p.frame+=1},e.exports.death=function(){u.death+=1,p.death+=1},e.exports.draw=function(){c.cls(),c.addText(u.getTime(),0,0),draw(c.texture,96,0)},e.exports.getResult=function(){return{levels:l,total:u}}},{"./TextBox":35}],52:[function(t,e,i){var n=i.EMPTY={isEmpty:!0,isSolid:!1,isTopSolid:!1,fruitSolid:!1,isTeleportable:!0,kill:!1,interactive:!1},s=i.SOLID={isEmpty:!1,isSolid:!0,isTopSolid:!0,fruitSolid:!0,isTeleportable:!1,kill:!1,interactive:!1},r=i.ONE_WAY={isEmpty:!1,isSolid:!1,isTopSolid:!0,fruitSolid:!1,isTeleportable:!0,kill:!1,interactive:!1},o=i.KILL={isEmpty:!0,isSolid:!1,isTopSolid:!1,fruitSolid:!1,isTeleportable:!1,kill:!0,interactive:!1},a=i.GLASS={isEmpty:!1,isSolid:!0,isTopSolid:!0,fruitSolid:!1,isTeleportable:!1,kill:!1,interactive:!1},h=i.DOOR1={isEmpty:!1,isSolid:!1,isTopSolid:!1,fruitSolid:!1,isTeleportable:!0,kill:!1,interactive:!0,door:1},l=(i.DOOR2={isEmpty:!1,isSolid:!1,isTopSolid:!1,fruitSolid:!1,isTeleportable:!0,kill:!1,interactive:!0,door:2},i.DOOR3={isEmpty:!1,isSolid:!1,isTopSolid:!1,fruitSolid:!1,isTeleportable:!0,kill:!1,interactive:!0,door:3},{0:s,1:r,6:o,7:a,16:h,33:a,67:s});i.getTileFromMapItem=function(t){return t?l[t.tile]||n:n}},{}],53:[function(t,e,i){var n=t("../gamepad").getAnyGamepad,s=t("../viewManager"),r=t("../TextBox"),o=(settings.screen.height,new r(160,144,assets.font.tetris).setColor(3)),a=0;o.setColor(1).addText("      HI THERE.",0,8*a++),a++,o.setColor(1).addText(" THIS IS OUR ENTRY",0,8*a++),o.setColor(1).addText("FOR THE GAMEBOYJAM#5",0,8*a++),o.setColor(1).addText("HELD BETWEEN OCT 1ST",0,8*a++),o.setColor(1).addText(" AND OCT 10TH 2016 ",0,8*a++),a++,o.setColor(3).addText("   SARAH O'DONNELL",0,8*a++),o.setColor(2).addText("ENDING ILLUSTRATIONS",0,8*a++),a++,o.setColor(3).addText("   MARK SPARLING",0,8*a++),o.setColor(2).addText("       MUSIC",0,8*a++),a++,o.setColor(3).addText("   CEDRIC STOQUER",0,8*a++),o.setColor(2).addText("   PIXELS, CODING",0,8*a++),a++,a++,o.setColor(1).addText(" THANKS FOR PLAYING ",0,8*a++),i.open=function(){camera(0,0),paper(3).cls(),draw(o.texture,0,0)},i.update=function(){var t=n();t.btnp.A&&s.open("title"),t.btnp.B&&s.open("title"),t.btnp.start&&s.open("title")}},{"../TextBox":35,"../gamepad":47,"../viewManager":63}],54:[function(t,e,i){var n=t("../TextBox"),s=t("../viewManager"),r=15,o=[[{img:null,duration:4},{img:assets.illustrations.monkeyReunion2,duration:1},{img:assets.illustrations.monkeyReunion1,duration:1},{img:assets.illustrations.monkeyReunion0,duration:30},{img:assets.illustrations.monkeyReunion1,duration:1},{img:assets.illustrations.monkeyReunion2,duration:1},{img:null,duration:2}],[{img:null,duration:4},{img:assets.illustrations.monkeyStorytime2,duration:1},{img:assets.illustrations.monkeyStorytime1,duration:1},{img:assets.illustrations.monkeyStorytime0,duration:30},{img:assets.illustrations.monkeyStorytime1,duration:1},{img:assets.illustrations.monkeyStorytime2,duration:1},{img:null,duration:8},{img:null,duration:1}]],a=new n(160,24,assets.font.tetris).setColor(0);a.addText("      THE END.",0,0),a.addText(" THANKS FOR PLAYING",0,16);var h=0,l=0,u=0,p=!1;i.open=function(t){t=t||{},p=!!t.speedrun,h=0,camera(0,0),paper(0).cls()},i.update=function(){if(h-=1,!(h>0)){var t=o[l][u];if(h=t.duration*r,t.img?draw(t.img,0,0):paper(0).cls(),u+=1,u>=o[l].length&&(u=0,l+=1,l>=o.length)){if(p)return s.open("speedrunResult");draw(a.texture,0,64),h=1/0}}}},{"../TextBox":35,"../viewManager":63}],55:[function(t,e,i){function n(){A=0,C=0,B=0,j=0}function r(t,e,i){p.layer.draw(assets.entity.doors[e+i],t[e].x*v-8,t[e].y*m-8)}function o(){n(),E=[],D=[];var t=assets.levels[O];if(!t)return O=0,void h.open("ending",{speedrun:H});var e=t.music;if(null===e)audioManager.stopLoopSound("sfx");else if(e){var s=assets.music[e];audioManager.playLoopSound("sfx",e,1,0,0,s.start,s.end)}if(t.intermission)return O+=1,void h.open("intermission",t);d.setLevel(O),p.load(t.id),S=t.paper,M=t.parallax;var o=p.getEntryPoints(),a=t.doorType||1;r(o,"entry",a),r(o,"exit",a),L=o.needKey,k=p.width*v-f,I=p.height*m-y,T.x=o.entry.x*v,T.y=o.entry.y*m,P=clip(T.x-g,0,k),R=clip(T.y-_,0,I),i.updateHealthHUD()}var a=t("Texture"),h=t("../viewManager"),l=t("../gamepad").getAnyGamepad,u=t("../Monkey"),p=t("../level"),c=t("../TextBox"),d=t("../speedrun"),f=settings.screen.width,y=settings.screen.height,v=settings.tileSize[0],m=settings.tileSize[0],g=~~(f/2)-4,_=~~(y/2)-4,w=.1,x=.35,b=.85,T=i.monkey=new u,S=0,M=1,P=0,R=0,A=0,C=0,B=0,j=0,O=0,k=0,I=0,L=!1,E=[],D=[],V=!1,z=0,F=new c(160,8,assets.font.tetris).setColor(3);F.paper=3;var N=new a(160,8),H=!1;d.reset(),i.shakeCamera=function(t){B=t,j=2*t*(Math.random()-.5)},i.getLevel=function(){return assets.levels[O]},i.isSpeedrunEnabled=function(){return H},i.open=function(t){t=t||{},t.resume||(void 0!==t.speedrun&&(H=t.speedrun),void 0!==t.level&&(O=t.level),o())},i.respawn=function(){T.reset(),o()},i.gotoNextLevel=function(){return L&&!T.hasKey?(i.displayMessage(" THE DOOR IS LOCKED"),void sfx("wrong")):(T.reset(),O+=1,void o())},i.update=function(){var t=l();if(t.btnp.start)return void h.open("pause");paper(S).cls(),T.update(t);var e=clip(T.x-g,0,k),i=clip(T.y-_,0,I),n=e-P;n>-1&&n<1?P=e:P+=n*w,R+=(i-R)*w,B-=A*x,j-=C*x,B*=b,j*=b,A+=B,C+=j;var s=P+A,r=R+C;camera(s*M,r*M),p.drawBackground(),camera(s,r),p.draw(),T.draw();for(var o=0;o<E.length;o++)E[o].draw();for(var o=0;o<D.length;o++)T.checkCollisionWithEntity(D[o]);camera(0,0),H&&(d.update(),d.draw()),V?(draw(F.texture,0,128),--z<=0&&(V=!1)):draw(N,0,128)},i.addEntity=function(t,e){E.push(t),e&&D.push(t)},i.removeEntityFromCollisions=function(t){index=D.indexOf(t),index!==-1&&D.splice(index,1)},i.removeEntity=function(t){var e=E.indexOf(t);e!==-1&&E.splice(e,1),i.removeEntityFromCollisions(t)},i.displayMessage=function(t){V=!0,z=80,F.cls(),F.addText(t,0,0)},i.updateHealthHUD=function(){N.clear();for(var t=0;t<T.maxLife;t++)s=t<T.lifePoints?assets.hud.healthFull:assets.hud.healthEmpty,N.draw(s,1+5*t,0)}},{"../Monkey":32,"../TextBox":35,"../gamepad":47,"../level":48,"../speedrun":51,"../viewManager":63,Texture:3}],56:[function(t,e,i){var n=t("../gamepad").getAnyGamepad,s=t("./gameView"),r=t("../viewManager"),o=t("../TextBox"),a=settings.tileSize[1],h=getMap("fondu"),l=new o(160,8,assets.font.tetris).setColor(0),u=new o(160,8,assets.font.tetris).setColor(0);l.addText("     GAME OVER",0,0),u.addText("      RETRY ?",0,0);var p=0;i.open=function(t){p=0},i.update=function(){if(camera(0,0),p+=1,p<=40)return draw(h,0,(p-h.height)*a),void draw(h,0,(18-p)*a,!1,!0);draw(l.texture,0,56),draw(u.texture,0,72);var t=n();(t.btnp.A||t.btnp.B||t.btnp.start)&&(s.respawn(),r.open("game"))}},{"../TextBox":35,"../gamepad":47,"../viewManager":63,"./gameView":55}],57:[function(t,e,i){var n=t("../gamepad").getAnyGamepad,s=t("../viewManager"),r=t("../TextBox"),o=new r(160,24,assets.font.tetris).setColor(3),a=0;i.open=function(t){t=t||{},o.clear(),o.addText("CHAPTER "+t.chapter,8,0),o.addText(t.title,8,16),camera(0,0),paper(3).cls(),draw(o.texture,0,64),a=0},i.update=function(){if(++a<10)return camera(0,0),paper(3).cls(),void draw(o.texture,0,64);var t=n();(a>=150||t.btnp.A||t.btnp.B||t.btnp.start)&&s.open("game")}},{"../TextBox":35,"../gamepad":47,"../viewManager":63}],58:[function(t,e,i){var n=t("../viewManager"),s=t("../gamepad").getAnyGamepad,r=t("../passGrid"),o=t("../TextBox"),a={},h=settings.tileSize[0],l=settings.tileSize[1],u=52,p=44,c=getMap("passBG"),d=c.width*h,f=[assets.hud.target.f0,assets.hud.target.f1,assets.hud.target.f1];ANIMATION_SPEED=.1;var y=new o(8*h,l,assets.font.tetris).setColor(0);y.addText("PASSWORD",0,0),function(){for(var t=assets.levels,e=0;e<t.length;e++){var i=t[e];i.password&&(a[i.password]=e)}}();var v={x:0,y:0,frame:0},m=new r,g=0;i.open=function(){camera(0,0),paper(1).cls()},i.update=function(){var t=s();if(t.btnp.right&&(v.x=(v.x+1)%5),t.btnp.left&&(v.x=(v.x+4)%5),t.btnp.down&&(v.y=(v.y+1)%5),t.btnp.up&&(v.y=(v.y+4)%5),t.btnp.A&&m.switchBit(v.x,v.y),t.btnr.B){var e=m.getPassword(),i=a[e];i?n.open("game",{level:i}):(sfx("wrong"),console.log(e))}t.btnp.start&&n.open("title"),v.frame+=ANIMATION_SPEED,
v.frame>=f.length&&(v.frame=0),g+=.5,g>=d&&(g=0),cls(),draw(c,g,0),draw(c,g-d,0),draw(y.texture,48,32),m.draw(u,p),draw(f[~~v.frame],v.x*h+u+4,v.y*l+p+4)}},{"../TextBox":35,"../gamepad":47,"../passGrid":50,"../viewManager":63}],59:[function(t,e,i){var n=t("./gameView"),s=t("../gamepad").getAnyGamepad,r=t("../viewManager"),o=t("../TextBox"),a=t("../passGrid"),h=new a,l=!1,u=0,p=new o(40,8,assets.font.tetris).setColor(0);p.addText("PAUSE",0,0),i.open=function(t){u=5,t=t||{},l=!1;var e=n.getLevel();e.password&&(h.setPassword(e.password),l=!0)},i.update=function(){if(u>1)return paper(1).pen(1),camera(0,0),rectfill(8*u,8*u,160-16*u,144-16*u),void(u-=1);draw(p.texture,60,32),l&&h.draw(52,56);var t=s();t.btnp.start&&r.open("game",{resume:!0})}},{"../TextBox":35,"../gamepad":47,"../passGrid":50,"../viewManager":63,"./gameView":55}],60:[function(t,e,i){function n(t){u.cls(),u.addText("RESULT",56,0),u.addText("STAGE   TIME    TRY",0,16);for(var e=t,i=0,n=p.levels;i<l&&e<n.length;){var s=n[e];e+=1,i+=1,s.data.intermission?u.addText(s.data.title,0,8*i+24):u.addText((" "+s.data.stage).slice(-2)+"   "+s.getTime()+"  "+h+"*"+s.death,8,8*i+24)}var r=p.total;u.addText("TOTAL "+r.getTime()+"  "+h+"*"+r.death,0,136),draw(u.texture,0,0)}function s(){c+=l,c>=p.levels.length&&(c=0),n(c)}var r=t("../TextBox"),o=t("../speedrun"),a=t("../gamepad"),h=chr$(64),l=11,u=new r(160,144,assets.font.tetris).setColor(3);u.paper=3;var p,c=0;i.open=function(t){camera(0,0),p=o.getResult(),n(c)},i.update=function(){var t=a.getAnyGamepad();t.btnp.A&&s(),t.btnp.B&&s(),t.btnp.start&&s()}},{"../TextBox":35,"../gamepad":47,"../speedrun":51}],61:[function(t,e,i){var n=t("../viewManager"),s=assets.icon.pixelbox,r=0;i.open=function(){r=-s.height,paper(3),audioManager.loadSound("logo")},i.update=function(){return r+=.5,cls(),r>=130?n.open("title"):void(r>=125||(64==r&&sfx("logo"),draw(s,32,Math.min(r,64))))}},{"../viewManager":63}],62:[function(t,e,i){function n(){var t=0;_.clear(),_.addText("START GAME",0,8*t++),_.addText("SPEEDRUN:"+(g?"ON":"OFF"),0,8*t++),_.addText("PASSWORD",0,8*t++),_.addText("CREDITS",0,8*t++)}function s(t){t.sx+=(t.ax-t.x)*T,t.sy+=(t.ay-t.y)*T,t.sx*=S,t.sy*=S,t.x+=t.sx,t.y+=t.sy}function r(){switch(m){case 0:o.open("game",{levelId:0,speedrun:g});break;case 1:g=!g,n();break;case 2:o.open("password");break;case 3:o.open("credit")}}var o=t("../viewManager"),a=t("../TextBox"),h=t("../gamepad"),l=settings.screen.height,u=4,p=88,c=getMap("title/background"),d=assets.icon.monkey,f=assets.icon.warp,y=assets.hud.cursor,v=0,m=0,g=!1,_=new a(128,32,assets.font.tetris).setColor(3),w=new a(128,8,assets.font.tetris).setColor(3);w.addText("  GBJAM#5 2016",0,0);var x={x:0,y:0,sx:0,sy:0,ax:16,ay:20},b={x:0,y:0,sx:0,sy:0,ax:36,ay:40},T=.01,S=.95;i.open=function(){x={x:-150,y:10,sx:0,sy:-2,ax:16,ay:20},b={x:190,y:-20,sx:0,sy:2,ax:36,ay:40},camera(0,0),paper(2),n();var t=assets.music.title;audioManager.playLoopSound("sfx","title",1,0,0,t.start,t.end)},i.update=function(){cls(),++v>l&&(v=0),draw(c,0,v),draw(c,0,v-l),s(x),s(b),draw(d,x.x,x.y),draw(f,b.x,b.y),draw(_.texture,40,p),draw(y,32,8*m+p),draw(w.texture,16,136);var t=h.getAnyGamepad();t.btnp.down&&(m+=1,m>=u&&(m=0)),t.btnp.up&&(m-=1,m<0&&(m=u-1)),t.btnp.A&&r(),t.btnp.B&&r(),t.btnp.start&&r(),1===m&&t.btnp.right&&(g=!g,n()),1===m&&t.btnp.left&&(g=!g,n())}},{"../TextBox":35,"../gamepad":47,"../viewManager":63}],63:[function(t,e,i){var n={};i.view=null,i.addView=function(t,e){n[t]=e},i.open=function(t,e){var s=n[t];return s?(i.view=s,void(s.open&&s.open(e))):console.error("view does not exist",t)},i.update=function(){i.view.update()}},{}]},{},[5]);